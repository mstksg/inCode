(()=>{var sansSerif="Helvetica Neue,Helvetica,Arial,sans-serif",sameArray=function(xs,ys){const lx=xs.length,ly=ys.length;if(lx==ly){for(const i of d3.range(lx))if(xs[i]!=ys[i])return false;return true}else return false},clamp=(x,a,b)=>Math.max(a,Math.min(b,x)),logMe=function(x){return function(){console.log(x)}},binom=function(n,k){let x=1;let i=1;while(i<=k){x=x*(n+1-i)/i;i=i+1};return x},_binom=binom,factorial=function(n){let i=2;let x=1;while(i<=n){x=x*i;i=i+1};return x},_chompPascal=function(q0,n,k0,f){let i=0;let q=q0;let k=k0;while(k>0){const x=binom(n+k-1,n-1);if(q>=x){i=i+1;q=q-x;k=k-1}else break};return f(i)(q)(k)},ixChomper=function(n,x,f){let k=0;let z=0;while(true){const z2=binom(n+k,n);if(z2>x){return f(x-z)(k)}else{k=k+1;z=z2}}},ixPascal=function(n,x){let y=x;let i=0;let res=[];while(true)if(i<n){ixChomper(n-i,y,(y2)=>function(s){y=y2;i=i+1;res.unshift(s)})}else return res},pascalIx=function(ps){let res=0;ps.forEach(function(p,i){if(p>0)res+=binom(p+i,p-1)});return res},maxBinom=function(n,lim){let i=0;while(true){if(binom(n+i,i)>lim)return i;i=i+1}},_maxBinom=maxBinom,memoInt=function(f){let table=[];return function(x){if(x in table){return table[x]}else{const res=f(x);table[x]=res;return res}}},_toIntMap=function(extractor,merger,bazaar){let res=[];bazaar((x)=>function(){extractor(x)((i)=>(y)=>function(){if(i in res){res[i]=merger(res[i])(y)}else res[i]=y})()})();return res},holeyForEach=function(xs,f){for(const i in xs)f(i,xs[i])},_unionsIntMap=function(merger,bazaar){let res=[];bazaar((xs)=>function(){holeyForEach(xs,function(i,x){if(i in res){res[i]=merger(res[i])(x)}else res[i]=x})})();return res},_filterIntMap=function(f,xs){let res=[];holeyForEach(xs,function(i,x){if(f(x))res[i]=x});return res},intMapKeys=function(xs){let res=[];holeyForEach(xs,(i,x)=>res.push(i));return res},_singletonIntMap=function(i,x){let res=[];res[i]=x;return res},MODE={OFF:0,CLEAR:1,SET:2},_setupDrawer=function(sel,size5,dispPts,callback){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10};return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width,window_size.height]).style("touch-action","none").style("max-width","15em").style("margin","auto").style("display","block"),copyForm=d3.select(sel).append("form").style("max-width","15em").style("margin","1em auto 0 auto").style("display","block").append("input").attr("id","copyblock").style("padding","0.25rem 0.5rem").style("font-size","90%").style("width","100%").style("border","1px solid #555").style("border-radius","3px"),helpMsg="Use grid to draw. Click on URL to copy permalink.",helpdisp=d3.select(sel).append("div").style("max-width","15em").style("height","2em").style("margin","1em auto 0 auto").style("display","block").append("p").style("text-align","center").style("font-style","italic").style("font-size","85%").style("line-height","133%").text(helpMsg);copyForm.on("click",function(e){const esel=e.srcElement;esel.select();esel.setSelectionRange(0,999999);document.execCommand("copy");helpdisp.text("URL copied!");setTimeout(function(){esel.setSelectionRange(0,0);helpdisp.text(helpMsg)},1e3)});let activePts=[];let currx=null;let curry2=null;let grid={};const mkOutput=function(){return activePts.flatMap((ys,x)=>ys.flatMap((b,y)=>b?[{x,y,val:1}]:[]))},drawGrid=function(){grid.drawer(mkOutput())},setCopy=function(){copyForm.attr("value",window.location.origin+window.location.pathname+"?points="+dispPts(mkOutput().map(({x,y})=>({x,y}))))},setGrid=function(xs){activePts=d3.range(size5.width).map(()=>d3.range(size5.height).map(()=>false));if(xs)xs.forEach(function({x,y}){activePts[x][y]=true});setCopy();drawGrid()};let mode=MODE.OFF;const drawer=function(x,y){currx=x;curry2=y;if(mode>MODE.OFF)if(!(x==null||y==null)){const oldset=activePts[x][y],newset=mode==MODE.SET;activePts[x][y]=newset;if(oldset!=newset)drawGrid()}},gridbox=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);grid=setupGrid(gridbox,"",size5.width,size5.height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:(x,y)=>drawer(x,y),onleave:function(){mode=MODE.OFF}});const clickon=function(e){if(e.cancelable)e.preventDefault();if(!(currx==null||curry2==null)){mode=activePts[currx][curry2]?MODE.CLEAR:MODE.SET}else mode=MODE.SET;drawer(currx,curry2)},clickoff=function(e){if(e.cancelable)e.preventDefault();mode=MODE.OFF;setCopy();callback(mkOutput().map(({x,y})=>({x,y})))()};if("ontouchstart" in document){grid.grid.on("touchstart",clickon).on("touchend",clickoff)}else grid.grid.on("mousedown",clickon).on("mouseup",clickoff);setGrid([]);return function(xs){return function(){setGrid(xs);callback(mkOutput().map(({x,y})=>({x,y})))()}}}},slider_size={height:50,width:200},neighbs2d=[{x:0,y:0},{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:-1,y:-1},{x:-1,y:1},{x:1,y:0},{x:1,y:-1},{x:1,y:1}],inRange=function(mn,mx,x){return x>=mn&&x<mx},_setupGolFlat=function(sel,showPts,{height:height8,width:width8,maxT,maxDim}){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10},cell_size={height:(window_size.height-margin.top-margin.bottom)/height8,width:(window_size.width-margin.left-margin.right)/width8};return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width,window_size.height]).style("touch-action","none").style("max-width","15em").style("margin","auto").style("display","block");let dimslidersvg=null;if(maxDim)dimslidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","0.5em auto 0 auto").style("display","block").style("overflow","visible");const slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","0.5em auto 0 auto").style("display","block").style("overflow","visible");let ptsdisp=null;if(showPts)ptsdisp=d3.select(sel).append("div").style("max-width","20em").style("height","10em").style("margin","1em auto 0 auto").style("display","block").append("p").style("text-align","center").style("font-size","90%").style("line-height","125%");let currTime=0;let currDim=0;let currSel=undefined2;let locked=false;let ptcache=[];let snapshots=d3.range(maxDim+1).map(()=>d3.range(maxT+1).map(()=>()=>[]));const grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let gridSetup={};const drawBoxes=function(t,d,sel_,forceNew){const newCells=forceNew||t!=currTime||d!=currDim,sel2=locked?currSel:sel_;if(newCells){ptcache=[];const cells2=snapshots[t][d]().map(function({x,y,pts}){if(x in ptcache){ptcache[x][y]=pts}else{ptcache[x]=[];ptcache[x][y]=pts};return{x,y,val:pts.length}});gridSetup.drawer(cells2)};if(sel2!=currSel||newCells)if(sel2){const{x,y}=sel2,pts=x in ptcache?y in ptcache[x]?ptcache[x][y]:[]:[];if(showPts)if(d>0){const ptsstring=pts.length==0?"(no points)":pts.map((pt)=>"<"+ixPascal(d,pt).join(",")+">").join(", ");ptsdisp.text(ptsstring).style("font-style",pts.length==0?"italic":"normal")}else ptsdisp.text(pts.length==0?"(no point)":"(single point)").style("font-style","italic");const equivGroup=snapshots[t][d]().flatMap(function(testpt){if(sameArray(testpt.pts,pts)){return[{x:testpt.x,y:testpt.y,val:1}]}else return[]});gridSetup.highlighter(equivGroup)}else{gridSetup.highlighter([]);if(showPts)ptsdisp.text("Hover to view points").style("font-style","italic")};currTime=t;currDim=d;currSel=sel2},clicky=function(){locked=!locked;if(locked){gridSetup.underlighter(0.05)}else gridSetup.underlighter(0)};gridSetup=setupGrid(grid,"",width8,height8,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(x,y){drawBoxes(currTime,currDim,{x,y},false);if("ontouchstart" in document)clicky()},onleave:()=>drawBoxes(currTime,currDim,undefined2,false)});if(showPts)gridSetup.grid.on("click",function(e){if(e.cancelable)e.preventDefault();clicky()});if(maxDim){const dimselbox=dimslidersvg.append("g").attr("transform","translate(15,10)"),dimslider=d3.sliderBottom().min(0).max(maxDim).step(1).width(slider_size.width-30).ticks(maxDim+1).tickFormat((v)=>v+2+"").displayFormat((v)=>v+2+"D").on("onchange",(d)=>drawBoxes(currTime,d,currSel,false));dimselbox.call(dimslider);dimslider.value(3)};const controller=setupTimer(slidersvg,maxT+1,slider_size.width,(i)=>drawBoxes(i,currDim,currSel,false));return function(newsnaps){return function(){snapshots=newsnaps;locked=false;controller.value(0);drawBoxes(0,currDim,undefined2,true)}}}},_setupGol3D=function(sel,{height:height8,width:width8,maxT}){return function(){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10};d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(maxT*2+1),window_size.height]).attr("width","100%").style("touch-action","none").style("margin","auto").style("display","block"),slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","0.5em auto").style("display","block").style("overflow","visible"),symmetries=d3.range(0,maxT+1).map((z)=>z>0?[-z,z]:[z]),cell_size={height:(window_size.height-margin.top-margin.bottom)/height8,width:(window_size.width-margin.left-margin.right)/width8},grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let fullGrid=[];let clearHighlights=[];let grids=[];const clearAllHighlights=function(){clearHighlights.forEach((highlighter)=>highlighter([]));clearHighlights=[]},highlightNeighbs=function(x,y,z,i){clearAllHighlights();[-1,0,1].forEach(function(dz){if(inRange(-maxT,maxT+1,z+dz)){const hltr=fullGrid[z+dz+maxT].highlighter,baseNeighbs=dz==0?neighbs2d.slice(1):neighbs2d;hltr(baseNeighbs.map((dxy)=>({x:x+dxy.x,y:y+dxy.y,val:1})).filter((xy)=>inRange(0,width8,xy.x)&&inRange(0,height8,xy.y)));clearHighlights.push(()=>hltr([]))}});grids[i].forEach(function(g){g.underlighter(0.25);clearHighlights.push(()=>g.underlighter(0))})};grids=symmetries.map(function(pos2,i){return pos2.map(function(z){const res=setupGrid(grid,"z = "+z,width8,height8,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(x,y){highlightNeighbs(x,y,z,i)},onleave:clearAllHighlights});res.grid.attr("transform",`translate(${(maxT+z)*window_size.width},0)`);fullGrid[z+maxT]={drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter};return{drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter}})});let splitCache=[];let refresh=[];let snapshots=d3.range(maxT+1).map(()=>()=>[]);const drawBoxes=function(j){refresh.forEach((drawer)=>drawer([]));refresh=[];let splitCells=[];if(j in splitCache){splitCells=splitCache[j]}else{const cells2=snapshots[j]();cells2.map(function({x,y,zs}){zs.map(function(z){if(z in splitCells){splitCells[z].push({x,y,val:1})}else splitCells[z]=[{x,y,val:1}]})});splitCache[j]=splitCells};holeyForEach(splitCells,function(z,ps){grids[z].forEach(function({drawer}){drawer(ps);refresh.push(drawer)})})},controller=setupTimer(slidersvg,maxT+1,slider_size.width,drawBoxes);return function(newsnaps){return function(){snapshots=newsnaps;splitCache=[];controller.value(0);drawBoxes(0)}}}},_setupGol4D=function(sel,{height:height8,width:width8,maxT}){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10},maxPascal=binom(2+maxT,maxT),symmetries=d3.range(0,maxPascal).map(function(i){const zw=ixPascal(2,i),z0=zw[0],w0=zw[1];let pos2=[{z:z0,w:w0}];if(z0!=w0)pos2.push({z:w0,w:z0});pos2.forEach(function({z,w}){if(z>0)pos2.push({z:-z,w});if(w>0)pos2.push({z,w:-w});if(z>0&&w>0)pos2.push({z:-z,w:-w})});return pos2}),cell_size={height:(window_size.height-margin.top-margin.bottom)/height8,width:(window_size.width-margin.left-margin.right)/width8};return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(maxT*2+1),window_size.height*(maxT*2+1)]).attr("width","100%").style("touch-action","none").style("margin","auto").style("display","block"),slidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","0.5em auto").style("display","block").style("overflow","visible"),grid=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`);let fullGrid=d3.range(2*maxT+1).map((c)=>[]);let clearHighlights=[];let grids=[];const clearAllHighlights=function(){clearHighlights.forEach((highlighter)=>highlighter([]));clearHighlights=[]},highlightNeighbs=function(x,y,z,w,i){clearAllHighlights();neighbs2d.forEach(function(dzw){if(inRange(-maxT,maxT+1,z+dzw.x)&&inRange(-maxT,maxT+1,w+dzw.y)){const hltr=fullGrid[z+dzw.x+maxT][w+dzw.y+maxT].highlighter,baseNeighbs=dzw.x==0&&dzw.y==0?neighbs2d.slice(1):neighbs2d;hltr(baseNeighbs.map((dxy)=>({x:x+dxy.x,y:y+dxy.y,val:1})).filter((xy)=>inRange(0,width8,xy.x)&&inRange(0,height8,xy.y)));clearHighlights.push(()=>hltr([]))}});grids[i].forEach(function(g){const intensity=Math.abs(z)==Math.abs(g.point.z)&&Math.abs(w)==Math.abs(g.point.w)?0.5:0.25;g.underlighter(intensity);clearHighlights.push(()=>g.underlighter(0))})};grids=symmetries.map(function(pos2,i){return pos2.map(function({z,w}){const res=setupGrid(grid,z+","+w,width8,height8,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(x,y){highlightNeighbs(x,y,z,w,i)},onleave:clearAllHighlights});res.grid.attr("transform",`translate(${(maxT+z)*window_size.width},${(maxT+w)*window_size.height})`);fullGrid[z+maxT][w+maxT]={drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter};return{drawer:res.drawer,highlighter:res.highlighter,underlighter:res.underlighter,point:{z,w}}})});let snapshots=d3.range(maxT+1).map(()=>()=>[]);let splitCache=[];let refresh=[];const drawBoxes=function(j){refresh.forEach((drawer)=>drawer([]));refresh=[];let splitCells=[];if(j in splitCache){splitCells=splitCache[j]}else{const cells2=snapshots[j]();cells2.map(function({x,y,zws}){zws.map(function(zw){if(zw in splitCells){splitCells[zw].push({x,y,val:1})}else splitCells[zw]=[{x,y,val:1}]})});splitCache[j]=splitCells};holeyForEach(splitCells,function(zw,ps){grids[zw].forEach(function({drawer}){drawer(ps);refresh.push(drawer)})})},controller=setupTimer(slidersvg,maxT+1,slider_size.width,drawBoxes);return function(newsnaps){return function(){snapshots=newsnaps;splitCache=[];controller.value(0);drawBoxes(0)}}}},pushOrAdd=function(xs,i,x){if(i in xs){xs[i].push(x)}else xs[i]=[x]},compressVals=function(ps){let xs=[];ps.forEach(function({x,y,val}){if(x in xs){if(!(y in xs[x]))xs[x][y]=0}else{xs[x]=[];xs[x][y]=0};xs[x][y]+=val});let out=[];holeyForEach(xs,function(x,ys){holeyForEach(ys,function(y,val){out.push({x,y,val})})});return out},neighbsArray=function(dim,maxZW,mkPt,reversed2){const maxPascal=binom(dim+maxZW,maxZW),neighbDeltas=d3.cross(...d3.range(dim).map(()=>[0,-1,1])).slice(1);let res=d3.range(0,maxPascal).map(()=>({neighbBox:[],neighbHighlight:[]}));d3.range(0,maxPascal).forEach(function(i){const pos2=ixPascal(dim,i);neighbDeltas.forEach(function(dp){const npos=d3.zip(pos2,dp).map(([p,dp2])=>Math.abs(p+dp2));npos.sort();const j=pascalIx(npos),newPt=mkPt(dp);if(j<maxPascal)if(reversed2){pushOrAdd(res[j].neighbHighlight,j,newPt);pushOrAdd(res[j].neighbBox,i,newPt)}else{pushOrAdd(res[i].neighbBox,j,newPt);pushOrAdd(res[i].neighbHighlight,i,newPt)}})});return res.map(({neighbBox,neighbHighlight})=>({neighbBox:neighbBox.map(compressVals),neighbHighlight:neighbHighlight.map(compressVals)}))},_drawGolSyms=function(sel,maxZ,{dim,gridSize,ptPos},reversed2){const window_size={height:200,width:200},margin={top:10,bottom:10,left:10,right:10},maxPascal=binom(dim+maxZ,maxZ),neighbs=neighbsArray(dim,maxZ,function(x){const p=ptPos(x.map((y)=>y+1));return{x:p.x,y:gridSize.height-1-p.y,val:1}},reversed2),topBorder=ptPos(ixPascal(dim,maxPascal-1));return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,window_size.width*(topBorder.x+1),window_size.height*(topBorder.y+1)]).style("max-width","30em").style("margin","auto").style("display","block"),allBoxes=svg.append("g");let boxes=[];let clearHighlights=[];const clearAllHighlights=function(){clearHighlights.forEach((clr)=>clr());clearHighlights=[]},highlightNeighbs=function(i){clearAllHighlights();holeyForEach(neighbs[i].neighbBox,function(j,ps){boxes[j].drawer(ps);boxes[j].settext(ps.length+"");boxes[j].underlighter(ps.length/8);clearHighlights.push(()=>boxes[j].drawer([]));clearHighlights.push(()=>boxes[j].settext(""));clearHighlights.push(()=>boxes[j].underlighter(0))});holeyForEach(neighbs[i].neighbHighlight,function(j,ps){boxes[j].highlighter(ps);clearHighlights.push(()=>boxes[j].highlighter([]))});if(!(i in neighbs[i].neighbBox)){boxes[i].settext("0");clearHighlights.push(()=>boxes[i].settext(""))}};boxes=d3.range(0,maxPascal).map(function(i){const zw=ixPascal(dim,i),pos2=ptPos(zw),res=(setupGrid(allBoxes,zw.join(", "),gridSize.width,gridSize.height,window_size.width-margin.left-margin.right,window_size.height-margin.top-margin.bottom,{onmove:function(){highlightNeighbs(i)},onleave:clearAllHighlights}));res.grid.attr("transform",`translate(${window_size.width*pos2.x+margin.left},${window_size.height*(topBorder.y-pos2.y)+margin.top})`);return{drawer:res.drawer,highlighter:res.highlighter,settext:res.settext,underlighter:res.underlighter}});return svg}},_drawGolSyms5D=function(sel,getNeighbs){const window_size={height:200,width:200},maxZWQ=5,margin={top:0,bottom:0,left:0,right:0,inter:30},maxPascal=binom(3+maxZWQ,maxZWQ),windowOffset=(i)=>i==0?0:binom(1+i,i-1),qOffset=(i)=>window_size.width*windowOffset(i)+margin.inter*i;let neighbs=[];const revNeighbs=d3.range(maxPascal).map(function(i){const ns=getNeighbs(i);holeyForEach(ns,function(j,wt){if(!(j in neighbs))neighbs[j]=[];neighbs[j][i]=wt});return ns});return function(){d3.select(sel).selectAll("p").remove();const svg=d3.select(sel).append("svg").attr("viewBox",[0,0,qOffset(maxZWQ+1),window_size.height*(maxZWQ+1)]).attr("width","100%").style("margin","auto").style("display","block"),setupBox=function(g,txt,boxsize,handlers){const box=g.append("g"),underlight=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","yellow").attr("opacity",0),outline=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("stroke-opacity",0.75),mover=function(e){if(e.cancelable)e.preventDefault();if("onmove" in handlers)handlers.onmove()},leaver=function(e){if("onleave" in handlers)handlers.onleave()},botlab=box.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",40).attr("font-family",sansSerif).attr("transform",`translate(${boxsize/2},${boxsize*7/8})`).text(txt),mkCircle=function(col){const circcont=box.append("g"),circ=circcont.append("circle").attr("fill",col).attr("r",0).attr("transform",`translate(0,${boxsize/2})`).attr("opacity",0.75).style("transition","r 500ms ease"),lab=circcont.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",50).attr("font-family",sansSerif).attr("font-weight","bold").attr("transform",`translate(0,${boxsize*(3/10)})`),circfunc=function setCirc(d,l){circ.attr("r",Math.sqrt(d)*boxsize/4);lab.text(l)};return{box,circcont,circfunc}},circ1=mkCircle("red");circ1.circcont.attr("transform",`translate(${boxsize/4},0)`);const circ2=mkCircle("blue");circ2.circcont.attr("transform",`translate(${boxsize*3/4},0)`);const capture=box.append("rect").attr("width",boxsize).attr("height",boxsize).attr("fill","white").attr("opacity",0);if("ontouchstart" in document){capture.on("touchstart",mover).on("touchend",leaver)}else capture.on("mouseenter",mover).on("mouseleave",leaver);const underlighter=function(o){underlight.attr("opacity",o)};return{box,circ1func:circ1.circfunc,circ2func:circ2.circfunc,underlighter}},allboxes=svg.append("g");let boxes=[];let clearHighlights=[];const clearNeighbs=function(){clearHighlights.forEach((clr)=>clr());clearHighlights=[]},highlightNeighbs=function(i){clearNeighbs();const to=neighbs[i],from2=revNeighbs[i];holeyForEach(to,function(x,weight){if(x in boxes){boxes[x].circ1func(weight/8,weight+"");boxes[x].underlighter(0.2);clearHighlights.push(()=>{boxes[x].circ1func(0,"");boxes[x].underlighter(0)})}});holeyForEach(from2,function(x,weight){if(x in boxes){boxes[x].circ2func(weight/8,weight+"");boxes[x].underlighter(0.2);clearHighlights.push(()=>{boxes[x].circ2func(0,"");boxes[x].underlighter(0)})}})};boxes=d3.range(0,maxPascal).map(function(i){const zwq=ixPascal(3,i),z0=zwq[0],w0=zwq[1],q0=zwq[2],boxfuncs=setupBox(allboxes,zwq.join(", "),window_size.width-margin.left-margin.right,{onmove:()=>highlightNeighbs(i),onleave:()=>clearNeighbs()});boxfuncs.box.attr("transform",`translate(${qOffset(q0)+window_size.width*z0+margin.left},${window_size.height*(maxZWQ-w0)+margin.top})`);return boxfuncs});return svg}},setupGrid=function(svg,label4,numx,numy,width8,height8,handlers){const cell_width=width8/numx,cell_height=height8/numy,grid=svg.append("g").style("touch-action","none"),underlight=grid.append("rect").attr("width",width8).attr("height",height8).attr("fill","yellow").attr("opacity",0),boxes=grid.append("g"),xlines=grid.append("g").selectAll("line").data(d3.range(numx-1)).join("line").attr("stroke-opacity",0.3).attr("stroke","black").attr("stroke-width",0.5).attr("x1",(d)=>(d+1)*cell_width).attr("y1",0).attr("x2",(d)=>(d+1)*cell_width).attr("y2",height8),ylines=grid.append("g").selectAll("line").data(d3.range(numy-1)).join("line").attr("stroke-opacity",0.3).attr("stroke","black").attr("stroke-width",0.5).attr("y1",(d)=>(d+1)*cell_height).attr("x1",0).attr("y2",(d)=>(d+1)*cell_height).attr("x2",width8),highlights=grid.append("g"),lab=grid.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",(width8+height8)/10).attr("font-family",sansSerif).attr("transform",`translate(${width8/2},${height8*9/10})`).attr("opacity",0.85).text(label4),hightext=grid.append("text").attr("fill","#333").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",(width8+height8)/6).attr("font-family",sansSerif).attr("transform",`translate(${width8/2},${height8*(2/3-1/20)})`).attr("opacity",0.85).text(""),outline=grid.append("rect").attr("width",width8).attr("height",height8).attr("fill","none").attr("stroke","black").attr("stroke-width",2).attr("stroke-opacity",0.75),capture=grid.append("rect").attr("width",width8).attr("height",height8).attr("fill","white").attr("opacity",0),mover=function(e){if(e.cancelable)e.preventDefault();const[mx,my]=e instanceof TouchEvent?d3.pointers(e,this)[0]:d3.pointer(e,this),x=Math.floor(mx/cell_width),y=Math.floor(my/cell_height);handlers.onmove(clamp(x,0,numx-1),clamp(y,0,numy-1))},leaver=function(e){handlers.onleave()};if("onmove" in handlers)if("ontouchstart" in document){capture.on("touchmove",mover).on("touchstart",mover)}else capture.on("mousemove",mover).on("mouseenter",mover);if("onleave" in handlers)if("ontouchstart" in document){capture.on("touchend",()=>handlers.onleave())}else capture.on("mouseleave",()=>handlers.onleave());const mkDrawer=function(s,col,o){return function(cells2){const max7=d3.max(cells2,(d)=>d.val),color=d3.scaleSequential(col).domain([0,max7]);s.selectAll("*").remove();s.selectAll("rect").data(cells2).join("rect").attr("width",cell_width).attr("height",cell_height).attr("x",(d)=>d.x*cell_width).attr("y",(d)=>d.y*cell_height).attr("fill",(d)=>color(d.val)).style("opacity",o)}};return{grid,drawer:mkDrawer(boxes,d3.interpolateGreens,0.8),highlighter:mkDrawer(highlights,d3.interpolateBlues,0.3),underlighter:function(o){underlight.attr("opacity",o)},settext:function(t){hightext.text(t)}}},setupTimer=function(svg,size5,width8,callback){const tAxis=function(g){const sliderino2=d3.sliderBottom().min(0).max(size5-1).step(1).width(width8-30).ticks(size5).tickFormat((v)=>"").displayFormat((v)=>"");g.call(sliderino2);return sliderino2};let timer=null;const subslider=svg.append("g"),slidercont=subslider.append("g").attr("transform","translate(15,10)"),sliderino=tAxis(slidercont.append("g")).on("onchange",callback);callback(sliderino.value());const button=subslider.append("g"),drawButton=function(g,playing,callback2){g.select("*").remove();g.append("rect").attr("width",50).attr("height",18).attr("rx",2).style("fill","#eee").attr("stroke","#aaa").attr("stroke-width",0.5).style("margin",0).style("padding",0).attr("transform",`translate(${width8/2-25},30)`);const txt=g.append("text").attr("fill","#555").style("text-anchor","middle").attr("pointer-events","none").attr("font-size",10).text(playing?"Pause":"Play"),tbb=txt.node().getBBox();txt.attr("transform",`translate(${width8/2},${30+18/2+tbb.height/2-2})`);g.on("click",null).on("click",callback2)},play_start=function(){button.call(drawButton,true,play_stop);play_tick();timer=setInterval(play_tick,1e3)},play_stop=function(){button.call(drawButton,false,play_start);clearInterval(timer);timer=null},play_tick=function(){const currval=sliderino.value(),nextval=(currval+1)%size5;sliderino.value(nextval)};play_stop();return sliderino},_buildHierarchy=function(x,f){return d3.hierarchy(x,f)},expandRun=(r)=>r.flatMap((d,i)=>d3.range(d).map(()=>i)),_drawTree=function(sel,vecRun,mkHier,getContrib){const margin={top:10,bottom:10,left:30,right:42},optSizeLim=85,maxZLim=5,expandChosens=function(c){const contlen=c.leftovers.length,choselen=c.chosen.length,pad=d3.range(contlen-choselen).map(()=>0),fullchose=pad.concat(c.chosen),expandLeft=expandRun(c.leftovers),prefix=expandLeft.length>0?"["+expandLeft.join(",")+"]":"",suffix=expandRun(fullchose).join(","),infix=prefix.length>0&&suffix.length>0?",":"";return"<"+prefix+infix+suffix+">"},expandParts=function(c){const parts=c.parts;return[parts.left,parts.here,parts.right].filter((x)=>!(x===null)).join("+")};return function(){d3.select(sel).selectAll("p").remove();const dimslidersvg=d3.select(sel).append("svg").attr("viewBox",[0,0,slider_size.width,slider_size.height]).style("max-width","15em").style("margin","0.25em auto 0 auto").style("display","block").style("overflow","visible"),formElems=d3.select(sel).append("form").style("max-width","15em").style("margin","0 auto 0 auto").style("display","block"),selbox=formElems.append("select").style("width","100%"),radioopt=[{label:"forward",checked:"false"},{label:"reverse",checked:"true"}];let forward2=false;const dirradio=formElems.append("div").style("width","100%").style("text-align","center").style("font-size","90%").style("margin-top","0.25em"),raddivs=dirradio.selectAll("div").data(radioopt).join("div").attr("class","pretty p-default p-round"),radinps=raddivs.append("input").attr("type","radio").attr("name","neighbdir").attr("value",(d)=>d.label).attr("checked",(d)=>d.checked?"":null);raddivs.append("div").attr("class","state").append("label").attr("for",(d)=>d.label).text((d)=>d.label);const svg=d3.select(sel).append("svg").attr("width","100%").style("margin","auto").style("overflow","visible").style("display","block"),setupSelect=function(dim){selbox.selectAll("*").remove();const maxZ=Math.min(maxBinom(dim,optSizeLim)-1,maxZLim),numOpts=binom(dim+maxZ,maxZ),ptOpts=d3.range(numOpts).map(function(d){const vr=vecRun(dim)(d).slice(0,-1),pt=ixPascal(dim,d);return{pt:d,disp:"<"+pt.join(",")+"> ("+vr.join("-")+")"}});selbox.selectAll("option").data(ptOpts).join("option").attr("value",(d)=>d.pt).text((d)=>d.disp)},dimselbox=dimslidersvg.append("g").attr("transform","translate(15,10)"),dimslider=d3.sliderBottom().min(1).max(6).step(1).width(slider_size.width-30).ticks(6).tickFormat((v)=>v+2+"").displayFormat((v)=>v+2+"D");dimselbox.call(dimslider);let currpt=[];currpt[1]=1;currpt[2]=4;currpt[3]=6;currpt[4]=22;currpt[5]=9;currpt[6]=9;const drawTree2=function(){svg.selectAll("*").remove();const dim=dimslider.value(),pt=currpt[dim],hier=mkHier(dim)(pt),numchild=hier.leaves().length,window_size={height:numchild*15+margin.top+margin.bottom,width:400},tree=d3.tree().size([window_size.height-margin.top-margin.bottom,window_size.width-margin.left-margin.right])(hier);svg.attr("viewBox",[0,0,window_size.width,window_size.height]);selbox.property("value",pt);const treecont=svg.append("g").attr("transform",`translate(${margin.left},${margin.top})`),link=treecont.append("g");link.selectAll("path").data(tree.links()).join("path").attr("fill","none").attr("stroke","#555").attr("stroke-opacity",0.4).attr("stroke-width",1).attr("d",d3.linkHorizontal().x((d)=>d.y).y((d)=>d.x));const node=treecont.append("g").attr("stroke-linejoin","round").attr("stroke-width",3).selectAll("g").data(tree.descendants()).join("g").attr("transform",(d)=>`translate(${d.y},${d.x})`),tooltip=treecont.append("g").style("opacity",0.95).attr("display","none");tooltip.append("rect").attr("width",40).attr("height",19).attr("x",-20).attr("y",6).style("fill","#fff").style("stroke","#666").style("stroke-width","0.5px");const tttext1=tooltip.append("text").attr("text-anchor","middle").style("font-size",6.5).attr("font-family",sansSerif).attr("x",0).attr("y",14),tttext2=tooltip.append("text").attr("text-anchor","middle").style("font-size",6).style("font-style","italic").attr("font-family",sansSerif).attr("x",0).attr("y",21),dots=node.append("circle").attr("opacity",0.75);node.append("text").attr("text-anchor","end").attr("dy",-1.5).attr("x",-4).attr("opacity",(d)=>"children" in d?0.9:0.5).text((d)=>getContrib(d.data)().leftovers.join("-")).style("font-weight",(d)=>d.parent?"normal":"bold");node.append("text").attr("text-anchor","end").attr("dy",4.5).attr("x",-4).attr("opacity",(d)=>d.parent?0.9:0.5).text(function(d){const c=getContrib(d.data)(),contlen=c.leftovers.length,choselen=c.chosen.length,pad=d3.range(contlen-choselen).map(()=>"_");return pad.concat(c.chosen).join("-")}).style("font-weight",(d)=>"children" in d?"normal":"bold").style("text-decoration",(d)=>"children" in d?"none":getContrib(d.data)().allSame?"line-through":"none");node.append("text").attr("text-anchor","start").attr("dy",2).attr("x",3).attr("opacity",0.9).text(function(d){const c=getContrib(d.data)(),m=forward2?c.multQ():c.multP();if("children" in d){return m.here}else{const endMult=c.allSame?0:m.total;return m.here+" \u2192 "+endMult}}).style("text-decoration",(d)=>"children" in d?"none":getContrib(d.data)().allSame?"line-through":"none");node.selectAll("text").attr("font-family",sansSerif).style("font-size",6).clone(true).lower().attr("stroke","white");const highlightNodes=function(d){const c=getContrib(d.data)(),targChosen=c.chosen;dots.filter((d2)=>sameArray(targChosen,getContrib(d2.data)().chosen)).attr("r",4).attr("fill","blue").attr("opacity","0.5");const ancs=d.ancestors(),checkAnc=function(q){for(const a of ancs)if(a==q)return true;return false};link.selectAll("path").filter((d2)=>checkAnc(d2.target)).attr("stroke-opacity",0.9);tooltip.attr("display",null).attr("transform",`translate(${d.y},${d.x})`);tttext1.text(expandChosens(c));tttext2.text(expandParts(c))},clearNodes=function(){dots.attr("r",(d)=>"children" in d&&d.parent?1.5:2).attr("fill",(d)=>"children" in d&&d.parent?"#333":"red").attr("opacity","0.75");link.selectAll("path").attr("stroke-opacity",0.4);tooltip.attr("display","none")};node.append("circle").attr("r",8).attr("opacity",0);if("ontouchstart" in document){node.on("touchstart",(e,d)=>highlightNodes(d)).on("touchend",()=>clearNodes())}else node.on("mouseenter",(e,d)=>highlightNodes(d)).on("mouseleave",()=>clearNodes());clearNodes()};radinps.on("change",function(d){forward2=d.srcElement.value==="forward";drawTree2()});dimslider.on("onchange",(d)=>{setupSelect(d);drawTree2()});selbox.on("change",function(d){currpt[dimslider.value()]=d.srcElement.value;drawTree2()});dimslider.value(4);drawTree2();return svg}},undefined2=0,_setInnerHTML=function(e,x){return function(){e.innerHTML=x}},preventDefault=function(e){return function(){e.preventDefault()}},arrayMap=function(f){return function(arr){var l=arr.length,result=new Array(l);for(var i=0;i<l;i++)result[i]=f(arr[i]);return result}},semigroupoidFn={compose:function(f){return function(g){return function(x){return f(g(x))}}}},compose=function(dict){return dict.compose},identity=function(dict){return dict.identity},categoryFn={identity:function(x){return x},Semigroupoid0:function(){return semigroupoidFn}},otherwise=true,flip=function(f){return function(b){return function(a){return f(a)(b)}}},$$const=function(a){return function(v){return a}},unit=void 0,$$Proxy=function(){function $$Proxy2(){};$$Proxy2.value=new $$Proxy2();return $$Proxy2}(),map=function(dict){return dict.map},$$void=function(dictFunctor){return map(dictFunctor)($$const(unit))},voidRight=function(dictFunctor){var map13=map(dictFunctor);return function(x){return map13($$const(x))}},functorArray={map:arrayMap},concatString=function(s1){return function(s2){return s1+s2}},reflectSymbol=function(dict){return dict.reflectSymbol},unsafeGet=function(label4){return function(rec){return rec[label4]}},semigroupString={append:concatString},append=function(dict){return dict.append},arrayApply=function(fs){return function(xs){var l=fs.length,k=xs.length,result=new Array(l*k),n=0;for(var i=0;i<l;i++){var f=fs[i];for(var j=0;j<k;j++)result[n++]=f(xs[j])};return result}},identity2=identity(categoryFn),applyArray={apply:arrayApply,Functor0:function(){return functorArray}},apply=function(dict){return dict.apply},applySecond=function(dictApply){var apply1=apply(dictApply),map10=map(dictApply.Functor0());return function(a){return function(b){return apply1(map10($$const(identity2))(a))(b)}}},pure=function(dict){return dict.pure},unless=function(dictApplicative){var pure12=pure(dictApplicative);return function(v){return function(v1){if(!v)return v1;if(v)return pure12(unit);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[v.constructor.name,v1.constructor.name])}}},liftA1=function(dictApplicative){var apply4=apply(dictApplicative.Apply0()),pure12=pure(dictApplicative);return function(f){return function(a){return apply4(pure12(f))(a)}}},empty=function(dict){return dict.empty},guard=function(dictAlternative){var pure5=pure(dictAlternative.Applicative0()),empty7=empty(dictAlternative.Plus1());return function(v){if(v)return pure5(unit);if(!v)return empty7;throw new Error("Failed pattern match at Control.Alternative (line 48, column 1 - line 48, column 54): "+[v.constructor.name])}},arrayBind=function(arr){return function(f){var result=[];for(var i=0,l=arr.length;i<l;i++)Array.prototype.push.apply(result,f(arr[i]));return result}},discard=function(dict){return dict.discard},bindArray={bind:arrayBind,Apply0:function(){return applyArray}},bind=function(dict){return dict.bind},bindFlipped=function(dictBind){return flip(bind(dictBind))},discardUnit={discard:function(dictBind){return bind(dictBind)}},liftM1=function(dictMonad){var bind4=bind(dictMonad.Bind1()),pure5=pure(dictMonad.Applicative0());return function(f){return function(a){return bind4(a)(function(a$prime){return pure5(f(a$prime))})}}},ap=function(dictMonad){var bind4=bind(dictMonad.Bind1()),pure5=pure(dictMonad.Applicative0());return function(f){return function(a){return bind4(f)(function(f$prime){return bind4(a)(function(a$prime){return pure5(f$prime(a$prime))})})}}},topChar=String.fromCharCode(65535),bottomChar=String.fromCharCode(0),topNumber=Number.POSITIVE_INFINITY,bottomNumber=Number.NEGATIVE_INFINITY,unsafeCompareImpl=function(lt){return function(eq3){return function(gt){return function(x){return function(y){return x<y?lt:x===y?eq3:gt}}}}},ordIntImpl=unsafeCompareImpl,ordStringImpl=unsafeCompareImpl,ordCharImpl=unsafeCompareImpl,refEq=function(r1){return function(r2){return r1===r2}},eqBooleanImpl=refEq,eqIntImpl=refEq,eqCharImpl=refEq,eqStringImpl=refEq,eqUnit={eq:function(v){return function(v1){return true}}},eqString={eq:eqStringImpl},eqRowNil={eqRecord:function(v){return function(v1){return function(v2){return true}}}},eqRecord=function(dict){return dict.eqRecord},eqRec=function(){return function(dictEqRecord){return{eq:eqRecord(dictEqRecord)($$Proxy.value)}}},eqInt={eq:eqIntImpl},eqChar={eq:eqCharImpl},eqBoolean={eq:eqBooleanImpl},eq1=function(dict){return dict.eq1},eq=function(dict){return dict.eq},eq2=eq(eqBoolean),eqRowCons=function(dictEqRecord){var eqRecord1=eqRecord(dictEqRecord);return function(){return function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(dictEq){var eq3=eq(dictEq);return{eqRecord:function(v){return function(ra){return function(rb){var tail3=eqRecord1($$Proxy.value)(ra)(rb),key=reflectSymbol2($$Proxy.value),get3=unsafeGet(key);return eq3(get3(ra))(get3(rb))&&tail3}}}}}}}},notEq=function(dictEq){var eq3=eq(dictEq);return function(x){return function(y){return eq2(eq3(x)(y))(false)}}},LT=function(){function LT2(){};LT2.value=new LT2();return LT2}(),GT=function(){function GT2(){};GT2.value=new GT2();return GT2}(),EQ=function(){function EQ2(){};EQ2.value=new EQ2();return EQ2}(),eqOrdering={eq:function(v){return function(v1){if(v instanceof LT&&v1 instanceof LT)return true;if(v instanceof GT&&v1 instanceof GT)return true;if(v instanceof EQ&&v1 instanceof EQ)return true;return false}}},intSub=function(x){return function(y){return x-y|0}},intAdd=function(x){return function(y){return x+y|0}},intMul=function(x){return function(y){return x*y|0}},zero=function(dict){return dict.zero},semiringInt={add:intAdd,zero:0,mul:intMul,one:1},one=function(dict){return dict.one},mul=function(dict){return dict.mul},add=function(dict){return dict.add},ringInt={sub:intSub,Semiring0:function(){return semiringInt}},eqRec2=eqRec(),notEq2=notEq(eqOrdering),ordString=function(){return{compare:ordStringImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqString}}}(),ordRecordNil={compareRecord:function(v){return function(v1){return function(v2){return EQ.value}}},EqRecord0:function(){return eqRowNil}},ordInt=function(){return{compare:ordIntImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqInt}}}(),ordChar=function(){return{compare:ordCharImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqChar}}}(),compareRecord=function(dict){return dict.compareRecord},ordRecord=function(){return function(dictOrdRecord){var eqRec1=eqRec2(dictOrdRecord.EqRecord0());return{compare:compareRecord(dictOrdRecord)($$Proxy.value),Eq0:function(){return eqRec1}}}},compare1=function(dict){return dict.compare1},compare=function(dict){return dict.compare},max=function(dictOrd){var compare3=compare(dictOrd);return function(x){return function(y){var v=compare3(x)(y);if(v instanceof LT)return y;if(v instanceof EQ)return x;if(v instanceof GT)return x;throw new Error("Failed pattern match at Data.Ord (line 181, column 3 - line 184, column 12): "+[v.constructor.name])}}},min=function(dictOrd){var compare3=compare(dictOrd);return function(x){return function(y){var v=compare3(x)(y);if(v instanceof LT)return x;if(v instanceof EQ)return x;if(v instanceof GT)return y;throw new Error("Failed pattern match at Data.Ord (line 172, column 3 - line 175, column 12): "+[v.constructor.name])}}},ordRecordCons=function(dictOrdRecord){var compareRecord1=compareRecord(dictOrdRecord),eqRowCons2=eqRowCons(dictOrdRecord.EqRecord0())();return function(){return function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol),eqRowCons1=eqRowCons2(dictIsSymbol);return function(dictOrd){var compare3=compare(dictOrd),eqRowCons22=eqRowCons1(dictOrd.Eq0());return{compareRecord:function(v){return function(ra){return function(rb){var key=reflectSymbol2($$Proxy.value),left=compare3(unsafeGet(key)(ra))(unsafeGet(key)(rb)),$95=notEq2(left)(EQ.value);if($95)return left;return compareRecord1($$Proxy.value)(ra)(rb)}}},EqRecord0:function(){return eqRowCons22}}}}}},top=function(dict){return dict.top},boundedChar={top:topChar,bottom:bottomChar,Ord0:function(){return ordChar}},bottom=function(dict){return dict.bottom},showIntImpl=function(n){return n.toString()},showRecordFields=function(dict){return dict.showRecordFields},showRecord=function(){return function(){return function(dictShowRecordFields){var showRecordFields1=showRecordFields(dictShowRecordFields);return{show:function(record){return"{"+(showRecordFields1($$Proxy.value)(record)+"}")}}}}},showInt={show:showIntImpl},show=function(dict){return dict.show},showRecordFieldsCons=function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(dictShowRecordFields){var showRecordFields1=showRecordFields(dictShowRecordFields);return function(dictShow){var show12=show(dictShow);return{showRecordFields:function(v){return function(record){var tail3=showRecordFields1($$Proxy.value)(record),key=reflectSymbol2($$Proxy.value),focus2=unsafeGet(key)(record);return" "+(key+(": "+(show12(focus2)+(","+tail3))))}}}}}},showRecordFieldsConsNil=function(dictIsSymbol){var reflectSymbol2=reflectSymbol(dictIsSymbol);return function(dictShow){var show12=show(dictShow);return{showRecordFields:function(v){return function(record){var key=reflectSymbol2($$Proxy.value),focus2=unsafeGet(key)(record);return" "+(key+(": "+(show12(focus2)+" ")))}}}}},identity3=identity(categoryFn),Nothing=function(){function Nothing2(){};Nothing2.value=new Nothing2();return Nothing2}(),Just=function(){function Just2(value0){this.value0=value0};Just2.create=function(value0){return new Just2(value0)};return Just2}(),maybe=function(v){return function(v1){return function(v2){if(v2 instanceof Nothing)return v;if(v2 instanceof Just)return v1(v2.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}},isNothing=maybe(true)($$const(false)),isJust=maybe(false)($$const(true)),functorMaybe={map:function(v){return function(v1){if(v1 instanceof Just)return new Just(v(v1.value0));return Nothing.value}}},map2=map(functorMaybe),fromMaybe=function(a){return maybe(a)(identity3)},fromJust=function(){return function(v){if(v instanceof Just)return v.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[v.constructor.name])}},eqMaybe=function(dictEq){var eq3=eq(dictEq);return{eq:function(x){return function(y){if(x instanceof Nothing&&y instanceof Nothing)return true;if(x instanceof Just&&y instanceof Just)return eq3(x.value0)(y.value0);return false}}}},applyMaybe={apply:function(v){return function(v1){if(v instanceof Just)return map2(v.value0)(v1);if(v instanceof Nothing)return Nothing.value;throw new Error("Failed pattern match at Data.Maybe (line 67, column 1 - line 69, column 30): "+[v.constructor.name,v1.constructor.name])}},Functor0:function(){return functorMaybe}},bindMaybe={bind:function(v){return function(v1){if(v instanceof Just)return v1(v.value0);if(v instanceof Nothing)return Nothing.value;throw new Error("Failed pattern match at Data.Maybe (line 125, column 1 - line 127, column 28): "+[v.constructor.name,v1.constructor.name])}},Apply0:function(){return applyMaybe}},applicativeMaybe=function(){return{pure:Just.create,Apply0:function(){return applyMaybe}}}(),altMaybe={alt:function(v){return function(v1){if(v instanceof Nothing)return v1;return v}},Functor0:function(){return functorMaybe}},plusMaybe=function(){return{empty:Nothing.value,Alt0:function(){return altMaybe}}}(),alternativeMaybe={Applicative0:function(){return applicativeMaybe},Plus1:function(){return plusMaybe}},pureE=function(a){return function(){return a}},bindE=function(a){return function(f){return function(){return f(a())()}}},intDegree=function(x){return Math.min(Math.abs(x),2147483647)},intDiv=function(x){return function(y){if(y===0)return 0;return y>0?Math.floor(x/y):-Math.floor(x/-y)}},intMod=function(x){return function(y){if(y===0)return 0;var yy=Math.abs(y);return(x%yy+yy)%yy}},commutativeRingInt={Ring0:function(){return ringInt}},mod=function(dict){return dict.mod},euclideanRingInt={degree:intDegree,div:intDiv,mod:intMod,CommutativeRing0:function(){return commutativeRingInt}},div=function(dict){return dict.div},monoidString={mempty:"",Semigroup0:function(){return semigroupString}},mempty=function(dict){return dict.mempty},$runtime_lazy=function(name15,moduleName,init2){var state3=0,val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init2();state3=2;return val}},monadEffect={Applicative0:function(){return applicativeEffect},Bind1:function(){return bindEffect}},bindEffect={bind:bindE,Apply0:function(){return $lazy_applyEffect(0)}},applicativeEffect={pure:pureE,Apply0:function(){return $lazy_applyEffect(0)}},$lazy_functorEffect=$runtime_lazy("functorEffect","Effect",function(){return{map:liftA1(applicativeEffect)}}),$lazy_applyEffect=$runtime_lazy("applyEffect","Effect",function(){return{apply:ap(monadEffect),Functor0:function(){return $lazy_functorEffect(0)}}}),functorEffect=$lazy_functorEffect(20),applyEffect=$lazy_applyEffect(23);function error(msg){return new Error(msg)}
function throwException(e){return function(){throw e}};var _new=function(val){return function(){return{value:val}}},read=function(ref){return function(){return ref.value}},write=function(val){return function(ref){return function(){ref.value=val}}},$$new=_new,$runtime_lazy2=function(name15,moduleName,init2){var state3=0,val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init2();state3=2;return val}},defer=function(dict){return dict.defer},fix=function(dictLazy){var defer1=defer(dictLazy);return function(f){var $lazy_go=$runtime_lazy2("go","Control.Lazy",function(){return defer1(function(v){return f($lazy_go(25))})}),go2=$lazy_go(25);return go2}},Tuple=function(){function Tuple2(value0,value1){this.value0=value0;this.value1=value1};Tuple2.create=function(value0){return function(value1){return new Tuple2(value0,value1)}};return Tuple2}(),snd=function(v){return v.value1},functorTuple={map:function(f){return function(m){return new Tuple(m.value0,f(m.value1))}}},fst=function(v){return v.value0},lift=function(dict){return dict.lift},monadEffectEffect={liftEffect:identity(categoryFn),Monad0:function(){return monadEffect}},liftEffect=function(dict){return dict.liftEffect},map3=map(functorMaybe),MaybeT=function(x){return x},runMaybeT=function(v){return v},monadTransMaybeT={lift:function(dictMonad){var $157=liftM1(dictMonad)(Just.create);return function($158){return MaybeT($157($158))}}},lift3=lift(monadTransMaybeT),functorMaybeT=function(dictFunctor){var map13=map(dictFunctor);return{map:function(f){return function(v){return map13(map3(f))(v)}}}},monadMaybeT=function(dictMonad){return{Applicative0:function(){return applicativeMaybeT(dictMonad)},Bind1:function(){return bindMaybeT(dictMonad)}}},bindMaybeT=function(dictMonad){var bind4=bind(dictMonad.Bind1()),pure5=pure(dictMonad.Applicative0());return{bind:function(v){return function(f){return bind4(v)(function(v1){if(v1 instanceof Nothing)return pure5(Nothing.value);if(v1 instanceof Just){var v2=f(v1.value0);return v2};throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 54, column 11 - line 56, column 42): "+[v1.constructor.name])})}},Apply0:function(){return applyMaybeT(dictMonad)}}},applyMaybeT=function(dictMonad){var functorMaybeT1=functorMaybeT(dictMonad.Bind1().Apply0().Functor0());return{apply:ap(monadMaybeT(dictMonad)),Functor0:function(){return functorMaybeT1}}},applicativeMaybeT=function(dictMonad){return{pure:function(){var $159=pure(dictMonad.Applicative0());return function($160){return MaybeT($159(Just.create($160)))}}(),Apply0:function(){return applyMaybeT(dictMonad)}}},monadEffectMaybe=function(dictMonadEffect){var Monad0=dictMonadEffect.Monad0(),monadMaybeT1=monadMaybeT(Monad0);return{liftEffect:function(){var $161=lift3(Monad0),$162=liftEffect(dictMonadEffect);return function($163){return $161($162($163))}}(),Monad0:function(){return monadMaybeT1}}},altMaybeT=function(dictMonad){var Bind1=dictMonad.Bind1(),bind4=bind(Bind1),pure5=pure(dictMonad.Applicative0()),functorMaybeT1=functorMaybeT(Bind1.Apply0().Functor0());return{alt:function(v){return function(v1){return bind4(v)(function(m){if(m instanceof Nothing)return v1;return pure5(m)})}},Functor0:function(){return functorMaybeT1}}},plusMaybeT=function(dictMonad){var altMaybeT1=altMaybeT(dictMonad);return{empty:pure(dictMonad.Applicative0())(Nothing.value),Alt0:function(){return altMaybeT1}}},alternativeMaybeT=function(dictMonad){var applicativeMaybeT1=applicativeMaybeT(dictMonad),plusMaybeT1=plusMaybeT(dictMonad);return{Applicative0:function(){return applicativeMaybeT1},Plus1:function(){return plusMaybeT1}}},replicateFill=function(count,value12){if(count<1)return[];var result=new Array(count);return result.fill(value12)},replicatePolyfill=function(count,value12){var result=[],n=0;for(var i=0;i<count;i++)result[n++]=value12;return result},replicateImpl=typeof Array.prototype.fill==="function"?replicateFill:replicatePolyfill,fromFoldableImpl=function(){function Cons3(head4,tail3){this.head=head4;this.tail=tail3};var emptyList={};function curryCons(head4){return function(tail3){return new Cons3(head4,tail3)}}
function listToArray(list){var result=[],count=0,xs=list;while(xs!==emptyList){result[count++]=xs.head;xs=xs.tail};return result};return function(foldr4,xs){return listToArray(foldr4(curryCons)(emptyList)(xs))}}(),indexImpl=function(just,nothing,xs,i){return i<0||i>=xs.length?nothing:just(xs[i])},findIndexImpl=function(just,nothing,f,xs){for(var i=0,l=xs.length;i<l;i++)if(f(xs[i]))return just(i);return nothing},foldrArray=function(f){return function(init2){return function(xs){var acc=init2,len=xs.length;for(var i=len-1;i>=0;i--)acc=f(xs[i])(acc);return acc}}},foldlArray=function(f){return function(init2){return function(xs){var acc=init2,len=xs.length;for(var i=0;i<len;i++)acc=f(acc)(xs[i]);return acc}}},bimap=function(dict){return dict.bimap},bifunctorTuple={bimap:function(f){return function(g){return function(v){return new Tuple(f(v.value0),g(v.value1))}}}},semigroupEndo=function(dictSemigroupoid){var compose2=compose(dictSemigroupoid);return{append:function(v){return function(v1){return compose2(v)(v1)}}}},unsafeCoerce2=function(x){return x},coerce=function(){return unsafeCoerce2},coerce2=coerce(),unwrap=function(){return coerce2},identity4=identity(categoryFn),foldr=function(dict){return dict.foldr},$$null=function(dictFoldable){return foldr(dictFoldable)(function(v){return function(v1){return false}})(true)},traverse_=function(dictApplicative){var applySecond2=applySecond(dictApplicative.Apply0()),pure5=pure(dictApplicative);return function(dictFoldable){var foldr22=foldr(dictFoldable);return function(f){return foldr22(function($454){return applySecond2(f($454))})(pure5(unit))}}},for_=function(dictApplicative){var traverse_1=traverse_(dictApplicative);return function(dictFoldable){return flip(traverse_1(dictFoldable))}},foldl=function(dict){return dict.foldl},intercalate=function(dictFoldable){var foldl22=foldl(dictFoldable);return function(dictMonoid){var append4=append(dictMonoid.Semigroup0()),mempty3=mempty(dictMonoid);return function(sep){return function(xs){var go2=function(v){return function(v1){if(v.init)return{init:false,acc:v1};return{init:false,acc:append4(v.acc)(append4(sep)(v1))}}};return foldl22(go2)({init:true,acc:mempty3})(xs).acc}}}},product=function(dictFoldable){var foldl22=foldl(dictFoldable);return function(dictSemiring){return foldl22(mul(dictSemiring))(one(dictSemiring))}},sum=function(dictFoldable){var foldl22=foldl(dictFoldable);return function(dictSemiring){return foldl22(add(dictSemiring))(zero(dictSemiring))}},foldableMaybe={foldr:function(v){return function(v1){return function(v2){if(v2 instanceof Nothing)return v1;if(v2 instanceof Just)return v(v2.value0)(v1);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}},foldl:function(v){return function(v1){return function(v2){if(v2 instanceof Nothing)return v1;if(v2 instanceof Just)return v(v1)(v2.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}},foldMap:function(dictMonoid){var mempty3=mempty(dictMonoid);return function(v){return function(v1){if(v1 instanceof Nothing)return mempty3;if(v1 instanceof Just)return v(v1.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[v.constructor.name,v1.constructor.name])}}}},foldMapDefaultR=function(dictFoldable){var foldr22=foldr(dictFoldable);return function(dictMonoid){var append4=append(dictMonoid.Semigroup0()),mempty3=mempty(dictMonoid);return function(f){return foldr22(function(x){return function(acc){return append4(f(x))(acc)}})(mempty3)}}},foldableArray={foldr:foldrArray,foldl:foldlArray,foldMap:function(dictMonoid){return foldMapDefaultR(foldableArray)(dictMonoid)}},foldMap=function(dict){return dict.foldMap},fold=function(dictFoldable){var foldMap22=foldMap(dictFoldable);return function(dictMonoid){return foldMap22(dictMonoid)(identity4)}},runFn2=function(fn){return function(a){return function(b){return fn(a,b)}}},runFn4=function(fn){return function(a){return function(b){return function(c){return function(d){return fn(a,b,c,d)}}}}},Additive=function(x){return x},semigroupAdditive=function(dictSemiring){var add2=add(dictSemiring);return{append:function(v){return function(v1){return add2(v)(v1)}}}},traverseArrayImpl=function(){function array1(a){return[a]}
function array2(a){return function(b){return[a,b]}}
function array3(a){return function(b){return function(c){return[a,b,c]}}}
function concat2(xs){return function(ys){return xs.concat(ys)}};return function(apply4){return function(map10){return function(pure5){return function(f){return function(array){function go2(bot,top2){switch(top2-bot){case 0:return pure5([]);case 1:return map10(array1)(f(array[bot]));case 2:return apply4(map10(array2)(f(array[bot])))(f(array[bot+1]));case 3:return apply4(apply4(map10(array3)(f(array[bot])))(f(array[bot+1])))(f(array[bot+2]));default:var pivot=bot+Math.floor((top2-bot)/4)*2;return apply4(map10(concat2)(go2(bot,pivot)))(go2(pivot,top2))}};return go2(0,array.length)}}}}}}(),identity5=identity(categoryFn),traverse=function(dict){return dict.traverse},traversableMaybe={traverse:function(dictApplicative){var pure5=pure(dictApplicative),map10=map(dictApplicative.Apply0().Functor0());return function(v){return function(v1){if(v1 instanceof Nothing)return pure5(Nothing.value);if(v1 instanceof Just)return map10(Just.create)(v(v1.value0));throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[v.constructor.name,v1.constructor.name])}}},sequence:function(dictApplicative){var pure5=pure(dictApplicative),map10=map(dictApplicative.Apply0().Functor0());return function(v){if(v instanceof Nothing)return pure5(Nothing.value);if(v instanceof Just)return map10(Just.create)(v.value0);throw new Error("Failed pattern match at Data.Traversable (line 115, column 1 - line 119, column 33): "+[v.constructor.name])}},Functor0:function(){return functorMaybe},Foldable1:function(){return foldableMaybe}},sequenceDefault=function(dictTraversable){var traverse22=traverse(dictTraversable);return function(dictApplicative){return traverse22(dictApplicative)(identity5)}},traversableArray={traverse:function(dictApplicative){var Apply0=dictApplicative.Apply0();return traverseArrayImpl(apply(Apply0))(map(Apply0.Functor0()))(pure(dictApplicative))},sequence:function(dictApplicative){return sequenceDefault(traversableArray)(dictApplicative)},Functor0:function(){return functorArray},Foldable1:function(){return foldableArray}},sequence=function(dict){return dict.sequence},$$for=function(dictApplicative){return function(dictTraversable){var traverse22=traverse(dictTraversable)(dictApplicative);return function(x){return function(f){return traverse22(f)(x)}}}},unfoldrArrayImpl=function(isNothing2){return function(fromJust4){return function(fst2){return function(snd2){return function(f){return function(b){var result=[],value12=b;while(true){var maybe2=f(value12);if(isNothing2(maybe2))return result;var tuple=fromJust4(maybe2);result.push(fst2(tuple));value12=snd2(tuple)}}}}}}},unfoldr1ArrayImpl=function(isNothing2){return function(fromJust4){return function(fst2){return function(snd2){return function(f){return function(b){var result=[],value12=b;while(true){var tuple=f(value12);result.push(fst2(tuple));var maybe2=snd2(tuple);if(isNothing2(maybe2))return result;value12=fromJust4(maybe2)}}}}}}},fromJust2=fromJust(),unfoldable1Array={unfoldr1:unfoldr1ArrayImpl(isNothing)(fromJust2)(fst)(snd)},fromJust3=fromJust(),unfoldr=function(dict){return dict.unfoldr},unfoldableArray={unfoldr:unfoldrArrayImpl(isNothing)(fromJust3)(fst)(snd),Unfoldable10:function(){return unfoldable1Array}},singleton2=function(a){return[a]},replicate=runFn2(replicateImpl),index=function(){return runFn4(indexImpl)(Just.create)(Nothing.value)}(),fromFoldable=function(dictFoldable){return runFn2(fromFoldableImpl)(foldr(dictFoldable))},findIndex=function(){return runFn4(findIndexImpl)(Just.create)(Nothing.value)}(),elemIndex=function(dictEq){var eq22=eq(dictEq);return function(x){return findIndex(function(v){return eq22(v)(x)})}},concatMap=flip(bind(bindArray)),mapMaybe=function(f){return concatMap(function(){var $189=maybe([])(singleton2);return function($190){return $189(f($190))}}())},catMaybes=mapMaybe(identity(categoryFn)),pow=function(x){return function(y){return Math.pow(x,y)|0}},defer2=function(thunk){var v=null;return function(){if(thunk===void 0)return v;v=thunk();thunk=void 0;return v}},force=function(l){return l()},functorLazy={map:function(f){return function(l){return defer2(function(v){return f(force(l))})}}},applyLazy={apply:function(f){return function(x){return defer2(function(v){return force(f)(force(x))})}},Functor0:function(){return functorLazy}},bindLazy={bind:function(l){return function(f){return defer2(function(v){return force(f(force(l)))})}},Apply0:function(){return applyLazy}},applicativeLazy={pure:function(a){return defer2(function(v){return a})},Apply0:function(){return applyLazy}},foldrWithIndex=function(dict){return dict.foldrWithIndex},Nil=function(){function Nil3(){};Nil3.value=new Nil3();return Nil3}(),Cons=function(){function Cons3(value0,value1){this.value0=value0;this.value1=value1};Cons3.create=function(value0){return function(value1){return new Cons3(value0,value1)}};return Cons3}(),foldableList={foldr:function(f){return function(b){var rev3=function(){var go2=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(v,v1){if(v1 instanceof Nil){$tco_done=true;return v};if(v1 instanceof Cons){$tco_var_v=new Cons(v1.value0,v);$copy_v1=v1.value1;return};throw new Error("Failed pattern match at Data.List.Types (line 107, column 7 - line 107, column 23): "+[v.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$copy_v1);return $tco_result}};return go2(Nil.value)}(),$284=foldl(foldableList)(flip(f))(b);return function($285){return $284(rev3($285))}}},foldl:function(f){var go2=function($copy_b){return function($copy_v){var $tco_var_b=$copy_b,$tco_done1=false,$tco_result;function $tco_loop(b,v){if(v instanceof Nil){$tco_done1=true;return b};if(v instanceof Cons){$tco_var_b=f(b)(v.value0);$copy_v=v.value1;return};throw new Error("Failed pattern match at Data.List.Types (line 111, column 12 - line 113, column 30): "+[v.constructor.name])};while(!$tco_done1)$tco_result=$tco_loop($tco_var_b,$copy_v);return $tco_result}};return go2},foldMap:function(dictMonoid){var append23=append(dictMonoid.Semigroup0()),mempty3=mempty(dictMonoid);return function(f){return foldl(foldableList)(function(acc){var $286=append23(acc);return function($287){return $286(f($287))}})(mempty3)}}},eq1List={eq1:function(dictEq){var eq3=eq(dictEq);return function(xs){return function(ys){var go2=function($copy_v){return function($copy_v1){return function($copy_v2){var $tco_var_v=$copy_v,$tco_var_v1=$copy_v1,$tco_done=false,$tco_result;function $tco_loop(v,v1,v2){if(!v2){$tco_done=true;return false};if(v instanceof Nil&&v1 instanceof Nil){$tco_done=true;return v2};if(v instanceof Cons&&v1 instanceof Cons){$tco_var_v=v.value1;$tco_var_v1=v1.value1;$copy_v2=v2&&eq3(v1.value0)(v.value0);return};$tco_done=true;return false};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$tco_var_v1,$copy_v2);return $tco_result}}};return go2(xs)(ys)(true)}}}},eq12=eq1(eq1List),eqList=function(dictEq){return{eq:eq12(dictEq)}},ord1List={compare1:function(dictOrd){var compare2=compare(dictOrd);return function(xs){return function(ys){var go2=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(v,v1){if(v instanceof Nil&&v1 instanceof Nil){$tco_done=true;return EQ.value};if(v instanceof Nil){$tco_done=true;return LT.value};if(v1 instanceof Nil){$tco_done=true;return GT.value};if(v instanceof Cons&&v1 instanceof Cons){var v2=compare2(v.value0)(v1.value0);if(v2 instanceof EQ){$tco_var_v=v.value1;$copy_v1=v1.value1;return};$tco_done=true;return v2};throw new Error("Failed pattern match at Data.List.Types (line 60, column 5 - line 60, column 20): "+[v.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$copy_v1);return $tco_result}};return go2(xs)(ys)}}},Eq10:function(){return eq1List}},compare12=compare1(ord1List),ordList=function(dictOrd){var eqList1=eqList(dictOrd.Eq0());return{compare:compare12(dictOrd),Eq0:function(){return eqList1}}},$runtime_lazy3=function(name15,moduleName,init2){var state3=0,val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init2();state3=2;return val}},unwrap2=unwrap(),map4=map(functorLazy),List=function(x){return x},Nil2=function(){function Nil3(){};Nil3.value=new Nil3();return Nil3}(),Cons2=function(){function Cons3(value0,value1){this.value0=value0;this.value1=value1};Cons3.create=function(value0){return function(value1){return new Cons3(value0,value1)}};return Cons3}(),nil=defer2(function(v){return Nil2.value}),step=function($319){return force(unwrap2($319))},semigroupList={append:function(xs){return function(ys){var go2=function(v){if(v instanceof Nil2)return step(ys);if(v instanceof Cons2)return new Cons2(v.value0,append(semigroupList)(v.value1)(ys));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 103, column 5 - line 103, column 21): "+[v.constructor.name])};return map4(go2)(unwrap2(xs))}}},append1=append(semigroupList),monoidList={mempty:nil,Semigroup0:function(){return semigroupList}},lazyList={defer:function(f){return defer2(function($320){return step(f($320))})}},defer3=defer(lazyList),functorList={map:function(f){return function(xs){var go2=function(v){if(v instanceof Nil2)return Nil2.value;if(v instanceof Cons2)return new Cons2(f(v.value0),map(functorList)(f)(v.value1));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 112, column 5 - line 112, column 17): "+[v.constructor.name])};return map4(go2)(unwrap2(xs))}}},cons=function(x){return function(xs){return defer2(function(v){return new Cons2(x,xs)})}},foldableList2={foldr:function(op){return function(z){return function(xs){var rev3=foldl(foldableList2)(flip(cons))(nil);return foldl(foldableList2)(flip(op))(z)(rev3(xs))}}},foldl:function(op){var go2=function($copy_b){return function($copy_xs){var $tco_var_b=$copy_b,$tco_done=false,$tco_result;function $tco_loop(b,xs){var v=step(xs);if(v instanceof Nil2){$tco_done=true;return b};if(v instanceof Cons2){$tco_var_b=op(b)(v.value0);$copy_xs=v.value1;return};throw new Error("Failed pattern match at Data.List.Lazy.Types (line 127, column 7 - line 129, column 40): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_b,$copy_xs);return $tco_result}};return go2},foldMap:function(dictMonoid){var append23=append(dictMonoid.Semigroup0()),mempty3=mempty(dictMonoid);return function(f){return foldl(foldableList2)(function(b){return function(a){return append23(b)(f(a))}})(mempty3)}}},unfoldable1List={unfoldr1:function(){var go2=function(f){return function(b){return defer3(function(v){var v1=f(b);if(v1.value1 instanceof Just)return cons(v1.value0)(go2(f)(v1.value1.value0));if(v1.value1 instanceof Nothing)return cons(v1.value0)(nil);throw new Error("Failed pattern match at Data.List.Lazy.Types (line 151, column 28 - line 153, column 33): "+[v1.constructor.name])})}};return go2}()},unfoldableList={unfoldr:function(){var go2=function(f){return function(b){return defer3(function(v){var v1=f(b);if(v1 instanceof Nothing)return nil;if(v1 instanceof Just)return cons(v1.value0.value0)(go2(f)(v1.value0.value1));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 157, column 28 - line 159, column 39): "+[v1.constructor.name])})}};return go2}(),Unfoldable10:function(){return unfoldable1List}},monadList={Applicative0:function(){return applicativeList},Bind1:function(){return bindList}},bindList={bind:function(xs){return function(f){var go2=function(v){if(v instanceof Nil2)return Nil2.value;if(v instanceof Cons2)return step(append1(f(v.value0))(bind(bindList)(v.value1)(f)));throw new Error("Failed pattern match at Data.List.Lazy.Types (line 180, column 5 - line 180, column 17): "+[v.constructor.name])};return map4(go2)(unwrap2(xs))}},Apply0:function(){return $lazy_applyList(0)}},applicativeList={pure:function(a){return cons(a)(nil)},Apply0:function(){return $lazy_applyList(0)}},$lazy_applyList=$runtime_lazy3("applyList","Data.List.Lazy.Types",function(){return{apply:ap(monadList),Functor0:function(){return functorList}}}),altList={alt:append1,Functor0:function(){return functorList}},plusList={empty:nil,Alt0:function(){return altList}},alternativeList={Applicative0:function(){return applicativeList},Plus1:function(){return plusList}},apply2=apply(applyLazy),map5=map(functorLazy),unwrap3=unwrap(),map1=map(functorMaybe),defer4=defer(lazyList),foldl2=foldl(foldableList2),fix2=fix(lazyList),unfoldr2=unfoldr(unfoldableList),map22=map(functorList),zipWith=function(f){return function(xs){return function(ys){var go2=function(v){return function(v1){if(v instanceof Nil2)return Nil2.value;if(v1 instanceof Nil2)return Nil2.value;if(v instanceof Cons2&&v1 instanceof Cons2)return new Cons2(f(v.value0)(v1.value0),zipWith(f)(v.value1)(v1.value1));throw new Error("Failed pattern match at Data.List.Lazy (line 705, column 3 - line 705, column 35): "+[v.constructor.name,v1.constructor.name])}};return apply2(map5(go2)(unwrap3(xs)))(unwrap3(ys))}}},zip=function(){return zipWith(Tuple.create)}(),uncons=function(xs){var v=step(xs);if(v instanceof Nil2)return Nothing.value;if(v instanceof Cons2)return new Just({head:v.value0,tail:v.value1});throw new Error("Failed pattern match at Data.List.Lazy (line 288, column 13 - line 290, column 44): "+[v.constructor.name])},take=function(n){var go2=function(v){return function(v1){if(v1 instanceof Nil2)return Nil2.value;if(v1 instanceof Cons2)return new Cons2(v1.value0,take(v-1|0)(v1.value1));throw new Error("Failed pattern match at Data.List.Lazy (line 505, column 3 - line 505, column 32): "+[v.constructor.name,v1.constructor.name])}},$202=n<=0;if($202)return $$const(nil);var $333=map5(go2(n));return function($334){return List($333(unwrap3($334)))}},tail=function(xs){return map1(function(v){return v.tail})(uncons(xs))},singleton4=function(a){return cons(a)(nil)},reverse2=function(xs){return defer4(function(v){return foldl2(flip(cons))(nil)(xs)})},repeat=function(x){return fix2(function(xs){return cons(x)(xs)})},range2=function(start2){return function(end){if(start2>end){var g=function(x){if(x>=end)return new Just(new Tuple(x,x-1|0));if(otherwise)return Nothing.value;throw new Error("Failed pattern match at Data.List.Lazy (line 151, column 13 - line 152, column 38): "+[x.constructor.name])};return unfoldr2(g)(start2)};if(otherwise){var f=function(x){if(x<=end)return new Just(new Tuple(x,x+1|0));if(otherwise)return Nothing.value;throw new Error("Failed pattern match at Data.List.Lazy (line 156, column 5 - line 157, column 30): "+[x.constructor.name])};return unfoldr2(f)(start2)};throw new Error("Failed pattern match at Data.List.Lazy (line 148, column 1 - line 148, column 32): "+[start2.constructor.name,end.constructor.name])}},mapMaybe2=function(f){var go2=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Nil2){$tco_done=true;return Nil2.value};if(v instanceof Cons2){var v1=f(v.value0);if(v1 instanceof Nothing){$copy_v=step(v.value1);return};if(v1 instanceof Just){$tco_done=true;return new Cons2(v1.value0,mapMaybe2(f)(v.value1))};throw new Error("Failed pattern match at Data.List.Lazy (line 448, column 5 - line 450, column 39): "+[v1.constructor.name])};throw new Error("Failed pattern match at Data.List.Lazy (line 446, column 3 - line 446, column 15): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result},$336=map5(go2);return function($337){return List($336(unwrap3($337)))}},iterate2=function(f){return function(x){return fix2(function(xs){return cons(x)(map22(f)(xs))})}},head2=function(xs){return map1(function(v){return v.head})(uncons(xs))},transpose=function(xs){var v=uncons(xs);if(v instanceof Nothing)return xs;if(v instanceof Just){var v1=uncons(v.value0.head);if(v1 instanceof Nothing)return transpose(v.value0.tail);if(v1 instanceof Just)return cons(cons(v1.value0.head)(mapMaybe2(head2)(v.value0.tail)))(transpose(cons(v1.value0.tail)(mapMaybe2(tail)(v.value0.tail))));throw new Error("Failed pattern match at Data.List.Lazy (line 746, column 7 - line 750, column 72): "+[v1.constructor.name])};throw new Error("Failed pattern match at Data.List.Lazy (line 742, column 3 - line 750, column 72): "+[v.constructor.name])},fromFoldable2=function(dictFoldable){return foldr(dictFoldable)(cons)(nil)},drop=function(n){var go2=function($copy_v){return function($copy_v1){var $tco_var_v=$copy_v,$tco_done=false,$tco_result;function $tco_loop(v,v1){if(v===0){$tco_done=true;return v1};if(v1 instanceof Nil2){$tco_done=true;return Nil2.value};if(v1 instanceof Cons2){$tco_var_v=v-1|0;$copy_v1=step(v1.value1);return};throw new Error("Failed pattern match at Data.List.Lazy (line 524, column 3 - line 524, column 15): "+[v.constructor.name,v1.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_v,$copy_v1);return $tco_result}},$349=map5(go2(n));return function($350){return List($349(unwrap3($350)))}},$runtime_lazy4=function(name15,moduleName,init2){var state3=0,val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init2();state3=2;return val}},Leaf=function(){function Leaf2(){};Leaf2.value=new Leaf2();return Leaf2}(),Node=function(){function Node3(value0,value1,value22,value32,value42,value52){this.value0=value0;this.value1=value1;this.value2=value22;this.value3=value32;this.value4=value42;this.value5=value52};Node3.create=function(value0){return function(value1){return function(value22){return function(value32){return function(value42){return function(value52){return new Node3(value0,value1,value22,value32,value42,value52)}}}}}};return Node3}(),IterLeaf=function(){function IterLeaf2(){};IterLeaf2.value=new IterLeaf2();return IterLeaf2}(),IterEmit=function(){function IterEmit2(value0,value1,value22){this.value0=value0;this.value1=value1;this.value2=value22};IterEmit2.create=function(value0){return function(value1){return function(value22){return new IterEmit2(value0,value1,value22)}}};return IterEmit2}(),IterNode=function(){function IterNode2(value0,value1){this.value0=value0;this.value1=value1};IterNode2.create=function(value0){return function(value1){return new IterNode2(value0,value1)}};return IterNode2}(),IterDone=function(){function IterDone2(){};IterDone2.value=new IterDone2();return IterDone2}(),IterNext=function(){function IterNext2(value0,value1,value22){this.value0=value0;this.value1=value1;this.value2=value22};IterNext2.create=function(value0){return function(value1){return function(value22){return new IterNext2(value0,value1,value22)}}};return IterNext2}(),Split=function(){function Split2(value0,value1,value22){this.value0=value0;this.value1=value1;this.value2=value22};Split2.create=function(value0){return function(value1){return function(value22){return new Split2(value0,value1,value22)}}};return Split2}(),SplitLast=function(){function SplitLast2(value0,value1,value22){this.value0=value0;this.value1=value1;this.value2=value22};SplitLast2.create=function(value0){return function(value1){return function(value22){return new SplitLast2(value0,value1,value22)}}};return SplitLast2}(),unsafeNode=function(k,v,l,r){if(l instanceof Leaf){if(r instanceof Leaf)return new Node(1,1,k,v,l,r);if(r instanceof Node)return new Node(1+r.value0|0,1+r.value1|0,k,v,l,r);throw new Error("Failed pattern match at Data.Map.Internal (line 680, column 5 - line 684, column 39): "+[r.constructor.name])};if(l instanceof Node){if(r instanceof Leaf)return new Node(1+l.value0|0,1+l.value1|0,k,v,l,r);if(r instanceof Node)return new Node(1+function(){var $277=l.value0>r.value0;if($277)return l.value0;return r.value0}()|0,(1+l.value1|0)+r.value1|0,k,v,l,r);throw new Error("Failed pattern match at Data.Map.Internal (line 686, column 5 - line 690, column 68): "+[r.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 678, column 32 - line 690, column 68): "+[l.constructor.name])},toMapIter=function(){return flip(IterNode.create)(IterLeaf.value)}(),stepWith=function(f){return function(next){return function(done){var go2=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof IterLeaf){$tco_done=true;return done(unit)};if(v instanceof IterEmit){$tco_done=true;return next(v.value0,v.value1,v.value2)};if(v instanceof IterNode){$copy_v=f(v.value1)(v.value0);return};throw new Error("Failed pattern match at Data.Map.Internal (line 918, column 8 - line 924, column 20): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result};return go2}}},singleton5=function(k){return function(v){return new Node(1,1,k,v,Leaf.value,Leaf.value)}},unsafeBalancedNode=function(){var height8=function(v){if(v instanceof Leaf)return 0;if(v instanceof Node)return v.value0;throw new Error("Failed pattern match at Data.Map.Internal (line 735, column 12 - line 737, column 26): "+[v.constructor.name])},rotateLeft=function(k,v,l,rk,rv,rl,rr){if(rl instanceof Node&&rl.value0>height8(rr))return unsafeNode(rl.value2,rl.value3,unsafeNode(k,v,l,rl.value4),unsafeNode(rk,rv,rl.value5,rr));return unsafeNode(rk,rv,unsafeNode(k,v,l,rl),rr)},rotateRight=function(k,v,lk,lv,ll,lr,r){if(lr instanceof Node&&height8(ll)<=lr.value0)return unsafeNode(lr.value2,lr.value3,unsafeNode(lk,lv,ll,lr.value4),unsafeNode(k,v,lr.value5,r));return unsafeNode(lk,lv,ll,unsafeNode(k,v,lr,r))};return function(k,v,l,r){if(l instanceof Leaf){if(r instanceof Leaf)return singleton5(k)(v);if(r instanceof Node&&r.value0>1)return rotateLeft(k,v,l,r.value2,r.value3,r.value4,r.value5);return unsafeNode(k,v,l,r)};if(l instanceof Node){if(r instanceof Node){if(r.value0>(l.value0+1|0))return rotateLeft(k,v,l,r.value2,r.value3,r.value4,r.value5);if(l.value0>(r.value0+1|0))return rotateRight(k,v,l.value2,l.value3,l.value4,l.value5,r)};if(r instanceof Leaf&&l.value0>1)return rotateRight(k,v,l.value2,l.value3,l.value4,l.value5,r);return unsafeNode(k,v,l,r)};throw new Error("Failed pattern match at Data.Map.Internal (line 695, column 40 - line 716, column 34): "+[l.constructor.name])}}(),$lazy_unsafeSplit=$runtime_lazy4("unsafeSplit","Data.Map.Internal",function(){return function(comp,k,m){if(m instanceof Leaf)return new Split(Nothing.value,Leaf.value,Leaf.value);if(m instanceof Node){var v=comp(k)(m.value2);if(v instanceof LT){var v1=$lazy_unsafeSplit(771)(comp,k,m.value4);return new Split(v1.value0,v1.value1,unsafeBalancedNode(m.value2,m.value3,v1.value2,m.value5))};if(v instanceof GT){var v1=$lazy_unsafeSplit(774)(comp,k,m.value5);return new Split(v1.value0,unsafeBalancedNode(m.value2,m.value3,m.value4,v1.value1),v1.value2)};if(v instanceof EQ)return new Split(new Just(m.value3),m.value4,m.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 769, column 5 - line 777, column 30): "+[v.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 765, column 34 - line 777, column 30): "+[m.constructor.name])}}),unsafeSplit=$lazy_unsafeSplit(764),$lazy_unsafeSplitLast=$runtime_lazy4("unsafeSplitLast","Data.Map.Internal",function(){return function(k,v,l,r){if(r instanceof Leaf)return new SplitLast(k,v,l);if(r instanceof Node){var v1=$lazy_unsafeSplitLast(757)(r.value2,r.value3,r.value4,r.value5);return new SplitLast(v1.value0,v1.value1,unsafeBalancedNode(k,v,l,v1.value2))};throw new Error("Failed pattern match at Data.Map.Internal (line 754, column 37 - line 758, column 57): "+[r.constructor.name])}}),unsafeSplitLast=$lazy_unsafeSplitLast(753),unsafeJoinNodes=function(v,v1){if(v instanceof Leaf)return v1;if(v instanceof Node){var v2=unsafeSplitLast(v.value2,v.value3,v.value4,v.value5);return unsafeBalancedNode(v2.value0,v2.value1,v2.value2,v1)};throw new Error("Failed pattern match at Data.Map.Internal (line 742, column 25 - line 746, column 38): "+[v.constructor.name,v1.constructor.name])},$lazy_unsafeUnionWith=$runtime_lazy4("unsafeUnionWith","Data.Map.Internal",function(){return function(comp,app,l,r){if(l instanceof Leaf)return r;if(r instanceof Leaf)return l;if(r instanceof Node){var v=unsafeSplit(comp,r.value2,l),l$prime=$lazy_unsafeUnionWith(787)(comp,app,v.value1,r.value4),r$prime=$lazy_unsafeUnionWith(788)(comp,app,v.value2,r.value5);if(v.value0 instanceof Just)return unsafeBalancedNode(r.value2,app(v.value0.value0)(r.value3),l$prime,r$prime);if(v.value0 instanceof Nothing)return unsafeBalancedNode(r.value2,r.value3,l$prime,r$prime);throw new Error("Failed pattern match at Data.Map.Internal (line 789, column 5 - line 793, column 46): "+[v.value0.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 782, column 42 - line 793, column 46): "+[l.constructor.name,r.constructor.name])}}),unsafeUnionWith=$lazy_unsafeUnionWith(781),unionWith=function(dictOrd){var compare2=compare(dictOrd);return function(app){return function(m1){return function(m2){return unsafeUnionWith(compare2,app,m1,m2)}}}},mapMaybeWithKey=function(dictOrd){return function(f){var go2=function(v){if(v instanceof Leaf)return Leaf.value;if(v instanceof Node){var v2=f(v.value2)(v.value3);if(v2 instanceof Just)return unsafeBalancedNode(v.value2,v2.value0,go2(v.value4),go2(v.value5));if(v2 instanceof Nothing)return unsafeJoinNodes(go2(v.value4),go2(v.value5));throw new Error("Failed pattern match at Data.Map.Internal (line 659, column 7 - line 663, column 47): "+[v2.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 656, column 8 - line 663, column 47): "+[v.constructor.name])};return go2}},mapMaybe3=function(dictOrd){var $763=mapMaybeWithKey(dictOrd);return function($764){return $763($$const($764))}},lookup=function(dictOrd){var compare2=compare(dictOrd);return function(k){var go2=function($copy_v){var $tco_done=false,$tco_result;function $tco_loop(v){if(v instanceof Leaf){$tco_done=true;return Nothing.value};if(v instanceof Node){var v1=compare2(k)(v.value2);if(v1 instanceof LT){$copy_v=v.value4;return};if(v1 instanceof GT){$copy_v=v.value5;return};if(v1 instanceof EQ){$tco_done=true;return new Just(v.value3)};throw new Error("Failed pattern match at Data.Map.Internal (line 281, column 7 - line 284, column 22): "+[v1.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 278, column 8 - line 284, column 22): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($copy_v);return $tco_result};return go2}},iterMapU=function(iter){return function(v){if(v instanceof Leaf)return iter;if(v instanceof Node){if(v.value4 instanceof Leaf){if(v.value5 instanceof Leaf)return new IterEmit(v.value2,v.value3,iter);return new IterEmit(v.value2,v.value3,new IterNode(v.value5,iter))};if(v.value5 instanceof Leaf)return new IterEmit(v.value2,v.value3,new IterNode(v.value4,iter));return new IterEmit(v.value2,v.value3,new IterNode(v.value4,new IterNode(v.value5,iter)))};throw new Error("Failed pattern match at Data.Map.Internal (line 951, column 17 - line 966, column 56): "+[v.constructor.name])}},stepUnorderedCps=stepWith(iterMapU),stepUnfoldrUnordered=function(){var step3=function(k,v,next){return new Just(new Tuple(new Tuple(k,v),next))};return stepUnorderedCps(step3)(function(v){return Nothing.value})}(),toUnfoldableUnordered=function(dictUnfoldable){var $765=unfoldr(dictUnfoldable)(stepUnfoldrUnordered);return function($766){return $765(toMapIter($766))}},iterMapL=function(){var go2=function($copy_iter){return function($copy_v){var $tco_var_iter=$copy_iter,$tco_done=false,$tco_result;function $tco_loop(iter,v){if(v instanceof Leaf){$tco_done=true;return iter};if(v instanceof Node){if(v.value5 instanceof Leaf){$tco_var_iter=new IterEmit(v.value2,v.value3,iter);$copy_v=v.value4;return};$tco_var_iter=new IterEmit(v.value2,v.value3,new IterNode(v.value5,iter));$copy_v=v.value4;return};throw new Error("Failed pattern match at Data.Map.Internal (line 929, column 13 - line 936, column 48): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_iter,$copy_v);return $tco_result}};return go2}(),stepAscCps=stepWith(iterMapL),stepAsc=function(){return stepAscCps(function(k,v,next){return new IterNext(k,v,next)})($$const(IterDone.value))}(),eqMapIter=function(dictEq){var eq14=eq(dictEq);return function(dictEq1){var eq22=eq(dictEq1);return{eq:function(){var go2=function($copy_a){return function($copy_b){var $tco_var_a=$copy_a,$tco_done=false,$tco_result;function $tco_loop(a,b){var v=stepAsc(a);if(v instanceof IterNext){var v2=stepAsc(b);if(v2 instanceof IterNext&&(eq14(v.value0)(v2.value0)&&eq22(v.value1)(v2.value1))){$tco_var_a=v.value2;$copy_b=v2.value2;return};$tco_done=true;return false};if(v instanceof IterDone){$tco_done=true;return true};throw new Error("Failed pattern match at Data.Map.Internal (line 837, column 14 - line 846, column 13): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_a,$copy_b);return $tco_result}};return go2}()}}},isEmpty=function(v){if(v instanceof Leaf)return true;return false},insertWith=function(dictOrd){var compare2=compare(dictOrd);return function(app){return function(k){return function(v){var go2=function(v1){if(v1 instanceof Leaf)return singleton5(k)(v);if(v1 instanceof Node){var v2=compare2(k)(v1.value2);if(v2 instanceof LT)return unsafeBalancedNode(v1.value2,v1.value3,go2(v1.value4),v1.value5);if(v2 instanceof GT)return unsafeBalancedNode(v1.value2,v1.value3,v1.value4,go2(v1.value5));if(v2 instanceof EQ)return new Node(v1.value0,v1.value1,k,app(v1.value3)(v),v1.value4,v1.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 484, column 7 - line 487, column 44): "+[v2.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 481, column 8 - line 487, column 44): "+[v1.constructor.name])};return go2}}}},insert=function(dictOrd){var compare2=compare(dictOrd);return function(k){return function(v){var go2=function(v1){if(v1 instanceof Leaf)return singleton5(k)(v);if(v1 instanceof Node){var v2=compare2(k)(v1.value2);if(v2 instanceof LT)return unsafeBalancedNode(v1.value2,v1.value3,go2(v1.value4),v1.value5);if(v2 instanceof GT)return unsafeBalancedNode(v1.value2,v1.value3,v1.value4,go2(v1.value5));if(v2 instanceof EQ)return new Node(v1.value0,v1.value1,k,v,v1.value4,v1.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 469, column 7 - line 472, column 35): "+[v2.constructor.name])};throw new Error("Failed pattern match at Data.Map.Internal (line 466, column 8 - line 472, column 35): "+[v1.constructor.name])};return go2}}},foldableMap={foldr:function(f){return function(z){var $lazy_go=$runtime_lazy4("go","Data.Map.Internal",function(){return function(m$prime,z$prime){if(m$prime instanceof Leaf)return z$prime;if(m$prime instanceof Node)return $lazy_go(170)(m$prime.value4,f(m$prime.value3)($lazy_go(170)(m$prime.value5,z$prime)));throw new Error("Failed pattern match at Data.Map.Internal (line 167, column 26 - line 170, column 43): "+[m$prime.constructor.name])}}),go2=$lazy_go(167);return function(m){return go2(m,z)}}},foldl:function(f){return function(z){var $lazy_go=$runtime_lazy4("go","Data.Map.Internal",function(){return function(z$prime,m$prime){if(m$prime instanceof Leaf)return z$prime;if(m$prime instanceof Node)return $lazy_go(176)(f($lazy_go(176)(z$prime,m$prime.value4))(m$prime.value3),m$prime.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 173, column 26 - line 176, column 43): "+[m$prime.constructor.name])}}),go2=$lazy_go(173);return function(m){return go2(z,m)}}},foldMap:function(dictMonoid){var mempty3=mempty(dictMonoid),append13=append(dictMonoid.Semigroup0());return function(f){var go2=function(v){if(v instanceof Leaf)return mempty3;if(v instanceof Node)return append13(go2(v.value4))(append13(f(v.value3))(go2(v.value5)));throw new Error("Failed pattern match at Data.Map.Internal (line 179, column 10 - line 182, column 28): "+[v.constructor.name])};return go2}}},foldableWithIndexMap={foldrWithIndex:function(f){return function(z){var $lazy_go=$runtime_lazy4("go","Data.Map.Internal",function(){return function(m$prime,z$prime){if(m$prime instanceof Leaf)return z$prime;if(m$prime instanceof Node)return $lazy_go(190)(m$prime.value4,f(m$prime.value2)(m$prime.value3)($lazy_go(190)(m$prime.value5,z$prime)));throw new Error("Failed pattern match at Data.Map.Internal (line 187, column 26 - line 190, column 45): "+[m$prime.constructor.name])}}),go2=$lazy_go(187);return function(m){return go2(m,z)}}},foldlWithIndex:function(f){return function(z){var $lazy_go=$runtime_lazy4("go","Data.Map.Internal",function(){return function(z$prime,m$prime){if(m$prime instanceof Leaf)return z$prime;if(m$prime instanceof Node)return $lazy_go(196)(f(m$prime.value2)($lazy_go(196)(z$prime,m$prime.value4))(m$prime.value3),m$prime.value5);throw new Error("Failed pattern match at Data.Map.Internal (line 193, column 26 - line 196, column 45): "+[m$prime.constructor.name])}}),go2=$lazy_go(193);return function(m){return go2(z,m)}}},foldMapWithIndex:function(dictMonoid){var mempty3=mempty(dictMonoid),append13=append(dictMonoid.Semigroup0());return function(f){var go2=function(v){if(v instanceof Leaf)return mempty3;if(v instanceof Node)return append13(go2(v.value4))(append13(f(v.value2)(v.value3))(go2(v.value5)));throw new Error("Failed pattern match at Data.Map.Internal (line 199, column 10 - line 202, column 30): "+[v.constructor.name])};return go2}},Foldable0:function(){return foldableMap}},keys=function(){return foldrWithIndex(foldableWithIndexMap)(function(k){return function(v){return function(acc){return new Cons(k,acc)}}})(Nil.value)}(),eqMap=function(dictEq){var eqMapIter1=eqMapIter(dictEq);return function(dictEq1){var eq14=eq(eqMapIter1(dictEq1));return{eq:function(xs){return function(ys){if(xs instanceof Leaf){if(ys instanceof Leaf)return true;return false};if(xs instanceof Node){if(ys instanceof Node&&xs.value1===ys.value1)return eq14(toMapIter(xs))(toMapIter(ys));return false};throw new Error("Failed pattern match at Data.Map.Internal (line 92, column 14 - line 103, column 16): "+[xs.constructor.name])}}}}},empty2=function(){return Leaf.value}(),fromFoldable3=function(dictOrd){var insert1=insert(dictOrd);return function(dictFoldable){return foldl(dictFoldable)(function(m){return function(v){return insert1(v.value0)(v.value1)(m)}})(empty2)}},fromFoldableWith=function(dictOrd){var insertWith1=insertWith(dictOrd);return function(dictFoldable){var foldl5=foldl(dictFoldable);return function(f){var f$prime=insertWith1(flip(f));return foldl5(function(m){return function(v){return f$prime(v.value0)(v.value1)(m)}})(empty2)}}},nullImpl=null;function nullable(a,r,f){return a==null?r:f(a)}
function notNull(x){return x};var toNullable=maybe(nullImpl)(notNull),toMaybe=function(n){return nullable(n,Nothing.value,Just.create)},coerce3=coerce(),foldMap2=foldMap(foldableList),foldl3=foldl(foldableList),foldr2=foldr(foldableList),toList=function(v){return keys(v)},singleton6=function(a){return singleton5(a)(unit)},isEmpty2=coerce3(isEmpty),insert2=function(dictOrd){var insert1=insert(dictOrd);return function(a){return function(v){return insert1(a)(unit)(v)}}},foldableSet={foldMap:function(dictMonoid){var foldMap12=foldMap2(dictMonoid);return function(f){var $98=foldMap12(f);return function($99){return $98(toList($99))}}},foldl:function(f){return function(x){var $100=foldl3(f)(x);return function($101){return $100(toList($101))}}},foldr:function(f){return function(x){var $102=foldr2(f)(x);return function($103){return $102(toList($103))}}}},eqSet=function(dictEq){var eq3=eq(eqMap(dictEq)(eqUnit));return{eq:function(v){return function(v1){return eq3(v)(v1)}}}},ordSet=function(dictOrd){var compare2=compare(ordList(dictOrd)),eqSet1=eqSet(dictOrd.Eq0());return{compare:function(s1){return function(s2){return compare2(toList(s1))(toList(s2))}},Eq0:function(){return eqSet1}}},empty3=empty2,fromFoldable4=function(dictFoldable){var foldl22=foldl(dictFoldable);return function(dictOrd){var insert1=insert2(dictOrd);return foldl22(function(m){return function(a){return insert1(a)(m)}})(empty3)}},coerce4=coerce(),singleton7=coerce4(singleton6),ordNonEmptySet=function(dictOrd){return ordSet(dictOrd)},fromSet=function(s){var $75=isEmpty2(s);if($75)return Nothing.value;return new Just(s)},fromFoldable5=function(dictFoldable){var fromFoldable23=fromFoldable4(dictFoldable);return function(dictOrd){var $84=fromFoldable23(dictOrd);return function($85){return fromSet($84($85))}}},foldableNonEmptySet=foldableSet,hasArrayFrom=typeof Array.from==="function",hasStringIterator=typeof Symbol!=="undefined"&&Symbol!=null&&typeof Symbol.iterator!=="undefined"&&typeof String.prototype[Symbol.iterator]==="function",hasFromCodePoint=typeof String.prototype.fromCodePoint==="function",hasCodePointAt=typeof String.prototype.codePointAt==="function",_unsafeCodePointAt0=function(fallback){return hasCodePointAt?function(str){return str.codePointAt(0)}:fallback},_countPrefix=function(fallback){return function(unsafeCodePointAt02){if(hasStringIterator)return function(pred){return function(str){var iter=str[Symbol.iterator]();for(var cpCount=0;;++cpCount){var o=iter.next();if(o.done)return cpCount;var cp=unsafeCodePointAt02(o.value);if(!pred(cp))return cpCount}}};return fallback}},_singleton=function(fallback){return hasFromCodePoint?String.fromCodePoint:fallback},_take=function(fallback){return function(n){if(hasStringIterator)return function(str){var accum="",iter=str[Symbol.iterator]();for(var i=0;i<n;++i){var o=iter.next();if(o.done)return accum;accum+=o.value};return accum};return fallback(n)}};function toCharCode(c){return c.charCodeAt(0)}
function fromCharCode(c){return String.fromCharCode(c)};var bottom1=bottom(boundedChar),top1=top(boundedChar),toEnum=function(dict){return dict.toEnum},fromEnum=function(dict){return dict.fromEnum},toEnumWithDefaults=function(dictBoundedEnum){var toEnum1=toEnum(dictBoundedEnum),fromEnum1=fromEnum(dictBoundedEnum),bottom2=bottom(dictBoundedEnum.Bounded0());return function(low2){return function(high2){return function(x){var v=toEnum1(x);if(v instanceof Just)return v.value0;if(v instanceof Nothing){var $140=x<fromEnum1(bottom2);if($140)return low2;return high2};throw new Error("Failed pattern match at Data.Enum (line 158, column 33 - line 160, column 62): "+[v.constructor.name])}}}},defaultSucc=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)+1|0)}}},defaultPred=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)-1|0)}}},charToEnum=function(v){if(v>=toCharCode(bottom1)&&v<=toCharCode(top1))return new Just(fromCharCode(v));return Nothing.value},enumChar={succ:defaultSucc(charToEnum)(toCharCode),pred:defaultPred(charToEnum)(toCharCode),Ord0:function(){return ordChar}},boundedEnumChar=function(){return{cardinality:toCharCode(top1)-toCharCode(bottom1)|0,toEnum:charToEnum,fromEnum:toCharCode,Bounded0:function(){return boundedChar},Enum1:function(){return enumChar}}}(),toCharArray=function(s){return s.split("")},singleton8=function(c){return c},length2=function(s){return s.length},drop2=function(n){return function(s){return s.substring(n)}},charAt=function(i){return function(s){if(i>=0&&i<s.length)return s.charAt(i);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}},split=function(sep){return function(s){return s.split(sep)}},$$null2=function(s){return s===""},fromEnum2=fromEnum(boundedEnumChar),div2=div(euclideanRingInt),mod2=mod(euclideanRingInt),CodePoint=function(x){return x},unsurrogate=function(lead){return function(trail){return(((lead-55296|0)*1024|0)+(trail-56320|0)|0)+65536|0}},isTrail=function(cu){return 56320<=cu&&cu<=57343},isLead=function(cu){return 55296<=cu&&cu<=56319},uncons2=function(s){var v=length2(s);if(v===0)return Nothing.value;if(v===1)return new Just({head:fromEnum2(charAt(0)(s)),tail:""});var cu1=fromEnum2(charAt(1)(s)),cu0=fromEnum2(charAt(0)(s)),$43=isLead(cu0)&&isTrail(cu1);if($43)return new Just({head:unsurrogate(cu0)(cu1),tail:drop2(2)(s)});return new Just({head:cu0,tail:drop2(1)(s)})},unsafeCodePointAt0Fallback=function(s){var cu0=fromEnum2(charAt(0)(s)),$47=isLead(cu0)&&length2(s)>1;if($47){var cu1=fromEnum2(charAt(1)(s)),$48=isTrail(cu1);if($48)return unsurrogate(cu0)(cu1);return cu0};return cu0},unsafeCodePointAt0=_unsafeCodePointAt0(unsafeCodePointAt0Fallback),fromCharCode2=function(){var $75=toEnumWithDefaults(boundedEnumChar)(bottom(boundedChar))(top(boundedChar));return function($76){return singleton8($75($76))}}(),singletonFallback=function(v){if(v<=65535)return fromCharCode2(v);var lead=div2(v-65536|0)(1024)+55296|0,trail=mod2(v-65536|0)(1024)+56320|0;return fromCharCode2(lead)+fromCharCode2(trail)},singleton9=_singleton(singletonFallback),takeFallback=function(v){return function(v1){if(v<1)return"";var v2=uncons2(v1);if(v2 instanceof Just)return singleton9(v2.value0.head)+takeFallback(v-1|0)(v2.value0.tail);return v1}},take3=_take(takeFallback),eqCodePoint={eq:function(x){return function(y){return x===y}}},drop3=function(n){return function(s){return drop2(length2(take3(n)(s)))(s)}},countTail=function($copy_p){return function($copy_s){return function($copy_accum){var $tco_var_p=$copy_p,$tco_var_s=$copy_s,$tco_done=false,$tco_result;function $tco_loop(p,s,accum){var v=uncons2(s);if(v instanceof Just){var $61=p(v.value0.head);if($61){$tco_var_p=p;$tco_var_s=v.value0.tail;$copy_accum=accum+1|0;return};$tco_done=true;return accum};$tco_done=true;return accum};while(!$tco_done)$tco_result=$tco_loop($tco_var_p,$tco_var_s,$copy_accum);return $tco_result}}},countFallback=function(p){return function(s){return countTail(p)(s)(0)}},countPrefix2=_countPrefix(countFallback)(unsafeCodePointAt0),dropWhile=function(p){return function(s){return drop3(countPrefix2(p)(s))(s)}},codePointFromChar=function($77){return CodePoint(fromEnum2($77))},unsafePerformEffect=function(f){return f()},unsafeThrowException=function($1){return unsafePerformEffect(throwException($1))},unsafeThrow=function($2){return unsafeThrowException(error($2))},isArray=Array.isArray||function(value12){return Object.prototype.toString.call(value12)==="[object Array]"},unsafeToForeign=unsafeCoerce2,embed=function(dict){return dict.embed},ana=function(dictCorecursive){var embed2=embed(dictCorecursive),map10=map(dictCorecursive.Functor0());return function(f){var go2=function(a){return embed2(map10(go2)(f(a)))};return go2}},getEffProp=function(name15){return function(doc){return function(){return doc[name15]}}},url=getEffProp("URL"),documentURI=getEffProp("documentURI"),origin=getEffProp("origin"),compatMode=getEffProp("compatMode"),characterSet=getEffProp("characterSet"),contentType=getEffProp("contentType"),_documentElement=getEffProp("documentElement");function createElement(localName2){return function(doc){return function(){return doc.createElement(localName2)}}}
function _unsafeReadProtoTagged(nothing,just,name15,value12){if(typeof window!=="undefined"){var ty=window[name15];if(ty!=null&&value12 instanceof ty)return just(value12)};var obj=value12;while(obj!=null){var proto=Object.getPrototypeOf(obj),constructorName=proto.constructor.name;if(constructorName===name15){return just(value12)}else if(constructorName==="Object")return nothing;obj=proto};return nothing};var unsafeReadProtoTagged=function(name15){return function(value12){return _unsafeReadProtoTagged(Nothing.value,Just.create,name15,value12)}},toParentNode=unsafeCoerce2,toEventTarget=unsafeCoerce2,getProp=function(name15){return function(doctype){return doctype[name15]}},_namespaceURI=getProp("namespaceURI"),_prefix=getProp("prefix"),localName=getProp("localName"),tagName=getProp("tagName");function setAttribute(name15){return function(value12){return function(element){return function(){element.setAttribute(name15,value12)}}}}
function _getAttribute(name15){return function(element){return function(){return element.getAttribute(name15)}}};var getEffProp2=function(name15){return function(node){return function(){return node[name15]}}},children=getEffProp2("children"),_firstElementChild=getEffProp2("firstElementChild"),_lastElementChild=getEffProp2("lastElementChild"),childElementCount=getEffProp2("childElementCount");function _querySelector(selector){return function(node){return function(){return node.querySelector(selector)}}}
function querySelectorAll(selector){return function(node){return function(){return node.querySelectorAll(selector)}}};var map7=map(functorEffect),querySelector=function(qs){var $2=map7(toMaybe),$3=_querySelector(qs);return function($4){return $2($3($4))}},map8=map(functorEffect),toParentNode2=unsafeCoerce2,toNode=unsafeCoerce2,toEventTarget2=unsafeCoerce2,getAttribute=function(attr){var $6=map8(toMaybe),$7=_getAttribute(attr);return function($8){return $6($7($8))}},fromNode=unsafeReadProtoTagged("Element"),getEffProp3=function(name15){return function(node){return function(){return node[name15]}}},baseURI=getEffProp3("baseURI"),_ownerDocument=getEffProp3("ownerDocument"),_parentNode=getEffProp3("parentNode"),_parentElement=getEffProp3("parentElement"),childNodes=getEffProp3("childNodes"),_firstChild=getEffProp3("firstChild"),_lastChild=getEffProp3("lastChild"),_previousSibling=getEffProp3("previousSibling"),_nextSibling=getEffProp3("nextSibling"),_nodeValue=getEffProp3("nodeValue"),textContent=getEffProp3("textContent");function setTextContent(value12){return function(node){return function(){node.textContent=value12}}}
function insertBefore(node1){return function(node2){return function(parent2){return function(){parent2.insertBefore(node1,node2)}}}}
function appendChild(node){return function(parent2){return function(){parent2.appendChild(node)}}}
function toArray(list){return function(){return[].slice.call(list)}}
function eventListener(fn){return function(){return function(event){return fn(event)()}}}
function addEventListener(type){return function(listener){return function(useCapture){return function(target5){return function(){return target5.addEventListener(type,listener,useCapture)}}}}};var windowImpl=function(){return window};function _title(doc){return doc.title};var toDocument=unsafeCoerce2,title=function(doc){return function(){return _title(doc)}},fromDocument=unsafeReadProtoTagged("HTMLDocument");function pushState(a){return function(docTitle){return function(url2){return function(history2){return function(){return history2.pushState(a,docTitle,url2)}}}}}
function hash(location2){return function(){return location2.hash}}
function origin2(location2){return function(){return location2.origin}}
function pathname(location2){return function(){return location2.pathname}}
function search(location2){return function(){return location2.search}}
function document2(window2){return function(){return window2.document}}
function location(window2){return function(){return window2.location}}
function history(window2){return function(){return window2.history}};var readystatechange="readystatechange",click2="click";function urlImpl(just){return function(nothing){return function(base){try{return just(new URL(base))}catch(TypeError){return nothing}}}}
function searchParams(url2){return url2.searchParams};var fromAbsolute=function(base){return urlImpl(Just.create)(Nothing.value)(base)};function urlSearchParamsImpl(x){return new URLSearchParams(x)}
function deleteImpl(name15){return function(p){var n=new URLSearchParams(p);n.delete(name15);return n}}
function getImpl(just){return function(nothing){return function(name15){return function(p){var v=p.get(name15);if(v===null){return nothing}else return just(v)}}}}
function toStringImpl(p){return p.toString()};var toString2=toStringImpl,get2=function(){return getImpl(Just.create)(Nothing.value)}(),fromString=urlSearchParamsImpl,$$delete3=deleteImpl,for_2=for_(applicativeEffect),showRecord2=showRecord()(),div3=div(euclideanRingInt),mod3=mod(euclideanRingInt),bind1=bind(bindList),pure2=pure(applicativeList),append2=append(semigroupString),map9=map(functorArray),for_1=for_2(foldableArray),lookup2=lookup(ordString),intercalate2=intercalate(foldableArray)(monoidString),discard2=discard(discardUnit),discard1=discard2(bindMaybe),guard2=guard(alternativeMaybe),eq13=eq(eqMaybe(eqInt)),pure1=pure(applicativeMaybe),for_22=for_2(foldableMaybe),ordNonEmptySet2=ordNonEmptySet(ordInt),fromFoldable7=fromFoldable4(foldableMap)(ordNonEmptySet2),bimap2=bimap(bifunctorTuple),semigroupAdditive2=semigroupAdditive(semiringInt),foldr3=foldr(foldableNonEmptySet),mempty2=mempty(monoidList),fromFoldable1=fromFoldable3(ordNonEmptySet2)(foldableList2),map12=map(functorList),fromFoldable22=fromFoldable2(foldableSet),fromFoldable32=fromFoldable5(foldableArray)(ordInt),foldl4=foldl(foldableList2),lookup1=lookup(ordNonEmptySet2),append12=append(semigroupEndo(semigroupoidFn)),toUnfoldableUnordered2=toUnfoldableUnordered(unfoldableList),pure22=pure(applicativeEffect),unless2=unless(applicativeEffect),bind2=bind(bindLazy),pure3=pure(applicativeLazy),show1=show(showInt),fromFoldable42=fromFoldable(foldableList2),max6=max(ordInt),min5=min(ordInt),append22=append(semigroupList),map23=map(functorLazy),product3=product(foldableList2)(semiringInt),liftEffect2=liftEffect(monadEffectEffect),bindFlipped2=bindFlipped(bindEffect),apply3=apply(applyEffect),map32=map(functorEffect),$$for2=$$for(applicativeEffect)(traversableArray),bindMaybeT2=bindMaybeT(monadEffect),bind3=bind(bindMaybeT2),liftEffect1=liftEffect(monadEffectMaybe(monadEffectEffect)),notEq3=notEq(eqCodePoint),map42=map(functorMaybeT(functorEffect)),discard3=discard2(bindMaybeT2),$$void2=$$void(functorEffect),pure4=pure(applicativeMaybeT(monadEffect)),map52=map(functorMaybe),elemIndex2=elemIndex(eqChar),yIsSymbol={reflectSymbol:function(){return"y"}},xIsSymbol={reflectSymbol:function(){return"x"}},ordRecord2=ordRecord()(ordRecordCons(ordRecordCons(ordRecordNil)()(yIsSymbol)(ordInt))()(xIsSymbol)(ordInt)),fromFoldable52=fromFoldable4(foldableList2)(ordRecord2),fromFoldable62=fromFoldable2(foldableArray),empty6=empty(plusMaybeT(monadEffect)),guard1=guard(alternativeMaybeT(monadEffect)),$$null4=$$null(foldableSet),traverse2=traverse(traversableMaybe)(applicativeEffect),fold2=fold(foldableArray)(monoidString),sequence2=sequence(traversableArray)(applicativeEffect),sum2=sum(foldableList2)(semiringInt),fromFoldableWith2=fromFoldableWith(ordRecord2)(foldableArray),fromFoldable72=fromFoldable(foldableSet),intercalate1=intercalate(foldableList2)(monoidString),foldMap3=foldMap(foldableList2)(monoidString),lookup22=lookup(ordRecord2),fromFoldable8=fromFoldable4(foldableArray)(ordRecord2),voidRight2=voidRight(functorList),guard22=guard(alternativeList),map62=map(functorTuple),bindFlipped1=bindFlipped(bindLazy),fromFoldable9=fromFoldable3(ordRecord2)(foldableList2),fromFoldable10=fromFoldable(foldableNonEmptySet),toUnfoldableUnordered1=toUnfoldableUnordered(unfoldableArray),NodeF=function(){function NodeF2(value0,value1){this.value0=value0;this.value1=value1};NodeF2.create=function(value0){return function(value1){return new NodeF2(value0,value1)}};return NodeF2}(),Node2=function(){function Node3(value0,value1){this.value0=value0;this.value1=value1};Node3.create=function(value0){return function(value1){return new Node3(value0,value1)}};return Node3}(),validLiveCount=function(v){return v>=5&&v<=7},unionsIntMap=function(dictFoldable){var for_3=for_2(dictFoldable);return function(dictSemigroup){var append4=append(dictSemigroup);return function(xs){return _unionsIntMap(append4,for_3(xs))}}},unionsIntMap1=unionsIntMap(foldableList2)(semigroupAdditive2),traverseNodeList_=function(dictMonadEffect){var Monad0=dictMonadEffect.Monad0(),bind4=bind(Monad0.Bind1()),liftEffect22=liftEffect(dictMonadEffect),traverse_2=traverse_(Monad0.Applicative0())(foldableArray);return function(f){return function(nl){return bind4(liftEffect22(toArray(nl)))(function(ns){return traverse_2(f)(mapMaybe(fromNode)(ns))})}}},traverseNodeList_1=traverseNodeList_(monadEffectEffect),toIntMap=function(dictFoldable){var for_3=for_2(dictFoldable);return function(dictSemigroup){var append4=append(dictSemigroup);return function(xs){return _toIntMap(function(v){return function(f){return f(v.value0)(v.value1)}},append4,for_3(xs))}}},toIntMap1=toIntMap(foldableList2)(semigroupAdditive2),singletonIntMap=runFn2(_singletonIntMap),setInnerHTML=runFn2(_setInnerHTML),semigroupFourBit={append:function(v){return function(v1){return{nw:v.nw||v1.nw,ne:v.ne||v1.ne,sw:v.sw||v1.sw,se:v.se||v1.se}}}},append3=append(semigroupFourBit),safeRange=function(x){return function(y){if(y>=x)return range2(x)(y);if(otherwise)return nil;throw new Error("Failed pattern match at Main (line 440, column 1 - line 440, column 36): "+[x.constructor.name,y.constructor.name])}},point2ToFourBit=function(v){var y$prime=div3(v.y)(2),x$prime=div3(v.x)(2),ly=mod3(v.y)(2),lx=mod3(v.x)(2);return new Tuple({x:x$prime,y:y$prime},{nw:lx===0&&ly===0,ne:lx===1&&ly===0,sw:lx===0&&ly===1,se:lx===1&&ly===1})},onE=function(etype){return function(targ){return function(h){return function __do(){var listener=eventListener(h)();return addEventListener(etype)(listener)(false)(targ)()}}}},maxBinom2=runFn2(_maxBinom),lowNeighbs=function(v){return bind1(cons(v.x)(cons(v.x-1|0)(cons(v.x+1|0)(nil))))(function(x$prime){return bind1(cons(v.y)(cons(v.y-1|0)(cons(v.y+1|0)(nil))))(function(y$prime){return pure2({x:x$prime,y:y$prime})})})},initialPoints=[{x:0,y:2},{x:1,y:0},{x:1,y:2},{x:2,y:1},{x:2,y:2}],functorVecTreeF=function(dictFunctor){var map72=map(dictFunctor);return{map:function(f){return function(m){return new NodeF(m.value0,map72(f)(m.value1))}}}},vecTreeCorec=function(dictFunctor){var functorVecTreeF1=functorVecTreeF(dictFunctor);return{embed:function(v){return new Node2(v.value0,v.value1)},Functor0:function(){return functorVecTreeF1}}},ana2=ana(vecTreeCorec(functorList)),fromDList=function(v){return v(nil)},fourBitList=function(v){return cons(v.nw)(cons(v.ne)(cons(v.sw)(cons(v.se)(nil))))},fourBitToPoint2=function(fb){var pts=cons({x:0,y:0})(cons({x:1,y:0})(cons({x:0,y:1})(cons({x:1,y:1})(nil))));return mapMaybe2(function(v){if(v.value1)return new Just(v.value0);return Nothing.value})(zip(pts)(fourBitList(fb)))},filterIntMap=runFn2(_filterIntMap),elementGroups=function(){return[new Tuple("#golDrawer",0),new Tuple("#gol2D",0),new Tuple("#gol3D",0),new Tuple("#golSyms3DForward",1),new Tuple("#golSyms3DReverse",1),new Tuple("#gol4D",0),new Tuple("#golSyms4DForward",1),new Tuple("#golSyms4DReverse",1),new Tuple("#golSyms5D",1),new Tuple("#golTree",1),new Tuple("#golFlat",0)]}(),elements=map9(fst)(elementGroups),elementGroupMap=fromFoldable3(ordString)(foldableArray)(elementGroups),makeElemLinks=function(doc){return function(elemMap){var linkStrings=flip(map9)(elemMap)(function(v){return new Tuple(v.value0,new Tuple(v.value1,'<a href="'+(v.value0+('">'+(v.value1+"</a>")))))});return for_1(elemMap)(function(v){var groupId=lookup2(v.value0)(elementGroupMap),linkString="Jump to: "+intercalate2(" / ")(flip(mapMaybe)(linkStrings)(function(v1){return discard1(guard2(eq13(lookup2(v1.value0)(elementGroupMap))(groupId)))(function(){return pure1(function(){var $345=v1.value0===v.value0;if($345)return v1.value1.value0;return v1.value1.value1}())})}));return function __do(){var container=querySelector(v.value0)(toParentNode(doc))();return for_22(container)(function(c){return function __do2(){var listp=createElement("p")(doc)();setInnerHTML(listp)(linkString)();return appendChild(toNode(listp))(toNode(c))()}})()}})}},dsingleton=function(x){return function(v){return cons(x)(v)}},stepper=function(dictOrd){var mapMaybe6=mapMaybe3(dictOrd),unionWith2=unionWith(dictOrd),fromFoldable11=fromFoldable3(dictOrd)(foldableList2);return function(dictShow){return function(expand){return function(syms){return function(cs){var uniqueGroups=fromFoldable7(cs),prebake=function(){var $442=bimap2(unionsIntMap1)(unionsIntMap1),$443=foldr3(function(pIx){return function(v){var pNeighbs=syms(pIx),there$prime=cons(singletonIntMap(pIx)(2))(cons(pNeighbs)(v.value1)),here$prime=cons(singletonIntMap(pIx)(1))(cons(pNeighbs)(v.value0));return new Tuple(here$prime,there$prime)}})(new Tuple(mempty2,mempty2));return function($444){return $442($443($444))}}(),prebaked=fromFoldable1(map12(function(gr){return new Tuple(gr,prebake(gr))})(fromFoldable22(uniqueGroups)));return mapMaybe6(function(){var $445=filterIntMap(validLiveCount);return function($446){return fromFoldable32(intMapKeys($445(unionsIntMap1(fromDList($446)))))}}())(foldl4(function(res){return function(v){var v1=lookup1(v.value1)(prebaked);if(v1 instanceof Nothing)return res;if(v1 instanceof Just)return flip(unionWith2(append12))(res)(fromFoldable11(zip(expand(v.value0))(cons(dsingleton(v1.value0.value0))(repeat(dsingleton(v1.value0.value1))))));throw new Error("Failed pattern match at Main (line 281, column 34 - line 285, column 96): "+[v1.constructor.name])}})(empty2)(toUnfoldableUnordered2(cs)))}}}}},stepper1=stepper(ordRecord2)(showRecord2(showRecordFieldsCons(xIsSymbol)(showRecordFieldsConsNil(yIsSymbol)(showInt))(showInt))),dropAlong=function($copy_xs){return function($copy_ys){var $tco_var_xs=$copy_xs,$tco_done=false,$tco_result;function $tco_loop(xs,ys){var v=step(xs);if(v instanceof Nil2){$tco_done=true;return ys};if(v instanceof Cons2){var v1=step(ys);if(v1 instanceof Nil2){$tco_done=true;return nil};if(v1 instanceof Cons2){$tco_var_xs=v.value1;$copy_ys=v1.value1;return};throw new Error("Failed pattern match at Main (line 507, column 22 - line 509, column 41): "+[v1.constructor.name])};throw new Error("Failed pattern match at Main (line 505, column 19 - line 509, column 41): "+[v.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_xs,$copy_ys);return $tco_result}},drawGolSyms4D=function(sel){return function(maxZ){return runFn4(_drawGolSyms)(sel)(maxZ)({dim:2,gridSize:{width:3,height:3},ptPos:function(v){if(v.length===2)return{x:v[0],y:v[1]};return unsafeThrow("drawGolSyms4D ptPos")}})}},drawGolSyms3D=function(sel){return function(maxZ){return runFn4(_drawGolSyms)(sel)(maxZ)({dim:1,gridSize:{width:3,height:1},ptPos:function(v){if(v.length===1)return{x:v[0],y:0};return unsafeThrow("drawGolSyms3D ptPos")}})}},doOnce=function(a){return function __do(){var doneRef=$$new(false)();return function __do2(){var done=read(doneRef)();return unless2(done)(function __do3(){a();return write(true)(doneRef)()})()}}},chompPascal=function(q){return function(n){return function(k){return _chompPascal(q,n,k,function(i$prime){return function(q$prime){return function(k$prime){return new Tuple(new Tuple(i$prime,q$prime),k$prime)}}})}}},genVecRunIxPascal=function(n){return function(mx){return function(x){var go2=function(q){return function(m){return function(k){var v=chompPascal(q)(m)(k),$374=m===1;if($374)return cons(v.value0.value0)(cons(v.value1)(nil));return cons(v.value0.value0)(go2(v.value0.value1)(m-1|0)(v.value1))}}};return go2(x)(mx)(n)}}},vecRunNeighbsTree=function(n){return function(orig){var mx=maxBinom2(n)(orig)+1|0,gens=genVecRunIxPascal(n)(mx)(orig),go2=function(v2){return new NodeF(v2.value1,function(){if(v2.value0 instanceof Nothing)return nil;if(v2.value0 instanceof Just){var v1=step(v2.value0.value0.ls0);if(v1 instanceof Nil2){var contrib=defer2(function(v22){var r$prime=fromMaybe(0)(v2.value0.value0.r),res=r$prime+v2.value0.value0.x|0,out$prime=cons(res)(v2.value0.value0.out),mulfact=defer2(function(v3){return factorial(v2.value0.value0.x)*factorial(r$prime)|0}),multP=bind2(v2.value0.value0.p)(function(p_){return bind2(mulfact)(function(m_){var pPow=pow(2)(r$prime),here=div3(factorial(res))(m_);return pure3({total:(p_*here|0)*pPow|0,here:"\xD7"+(show1(here)+("\xD7"+show1(pPow)))})})}),multQ=bind2(v2.value0.value0.q)(function(q_){return bind2(mulfact)(function(m_){var qPow=pow(2)(v2.value0.value0.x0-v2.value0.value0.x|0);return pure3({total:div3(q_*qPow|0)(m_),here:"\xF7"+(show1(m_)+("\xD7"+show1(qPow)))})})}),chosen=fromFoldable42(out$prime),allSame$prime=v2.value0.value0.allSame&&v2.value0.value0.x===v2.value0.value0.x0;return{chosen,multP,multQ,allSame:allSame$prime,leftovers:replicate(mx+1|0)(0),parts:{left:nullImpl,here:notNull(v2.value0.value0.x),right:toNullable(v2.value0.value0.r)}}});return singleton4(new Tuple(Nothing.value,contrib))};if(v1 instanceof Cons2)return bind1(safeRange(0)(v2.value0.value0.x+v1.value0|0))(function(xlContrib){return bind1(safeRange(max6(0)(xlContrib-v2.value0.value0.x|0))(min5(v1.value0)(xlContrib)))(function(lContrib){var xContrib=xlContrib-lContrib|0,x$prime=v2.value0.value0.x-xContrib|0,r$prime=fromMaybe(0)(v2.value0.value0.r),res=r$prime+xlContrib|0,out$prime=cons(res)(v2.value0.value0.out),mulfact=defer2(function(v22){return(factorial(r$prime)*factorial(xContrib)|0)*factorial(lContrib)|0}),multP=bind2(v2.value0.value0.p)(function(p_){return bind2(mulfact)(function(m_){var here=div3(factorial(res))(m_);return pure3({total:p_*here|0,here:"\xD7"+show1(here)})})}),multQ=bind2(v2.value0.value0.q)(function(q_){return bind2(mulfact)(function(m_){return pure3({total:div3(q_)(m_),here:"\xF7"+show1(m_)})})}),l$prime=v1.value0-lContrib|0,j$prime=v2.value0.value0.j-res|0,i$prime=v2.value0.value0.i-1|0,allSame$prime=v2.value0.value0.allSame&&xContrib===v2.value0.value0.x0,contrib2=defer2(function(v22){return{chosen:fromFoldable42(out$prime),multP,multQ,allSame:allSame$prime,leftovers:fromFoldable42(take(mx+1|0)(function(v3){return append22(v3)(repeat(0))}(reverse2(cons(x$prime)(cons(l$prime)(drop(2)(dropAlong(v2.value0.value0.out)(gens)))))))),parts:{left:notNull(lContrib),here:notNull(xContrib),right:toNullable(v2.value0.value0.r)}}});return pure2(new Tuple(new Just({i:i$prime,j:j$prime,out:out$prime,x0:v1.value0,allSame:allSame$prime,p:map23(function(v22){return v22.total})(multP),q:map23(function(v22){return v22.total})(multQ),r:new Just(x$prime),x:l$prime,ls0:v1.value1}),contrib2))})});throw new Error("Failed pattern match at Main (line 558, column 59 - line 681, column 24): "+[v1.constructor.name])};throw new Error("Failed pattern match at Main (line 556, column 23 - line 681, column 24): "+[v2.value0.constructor.name])}())},initQ=defer2(function(v2){return product3(map12(factorial)(gens))}),v=step(gens);if(v instanceof Nil2)return unsafeThrow("vecRunNeighbsTree step gens");if(v instanceof Cons2)return ana2(go2)(new Tuple(new Just({i:mx,j:n,out:nil,x0:v.value0,allSame:true,p:defer2(function(v1){return 1}),q:initQ,r:Nothing.value,x:v.value0,ls0:v.value1}),defer2(function(v1){var leftovers=fromFoldable42(reverse2(gens));return{chosen:[],multP:defer2(function(v2){return{total:1,here:"=1"}}),multQ:flip(map23)(initQ)(function(q){return{total:q,here:"="+show1(q)}}),leftovers:fromFoldable42(reverse2(gens)),allSame:true,parts:{left:nullImpl,here:nullImpl,right:nullImpl}}})));throw new Error("Failed pattern match at Main (line 517, column 28 - line 546, column 12): "+[v.constructor.name])}},buildHierarchy=runFn2(_buildHierarchy),vecTreeHierarchy=function(dictFoldable){var fromFoldable11=fromFoldable(dictFoldable);return function(xs){return buildHierarchy(xs)(function(v){return fromFoldable11(v.value1)})}},vecTreeHierarchy1=vecTreeHierarchy(foldableList2),drawTree=function(sel){var vecRun=function(d){return function(n){var mx=maxBinom2(d)(n)+1|0,gens=genVecRunIxPascal(d)(mx)(n);return fromFoldable42(reverse2(gens))}},mkHier=function(d){var $447=vecRunNeighbsTree(d);return function($448){return vecTreeHierarchy1($447($448))}};return _drawTree(sel,vecRun,mkHier,function(v){return v.value0})},buildElemMap=function(doc){return function __do(){var loc=liftEffect2(bindFlipped2(location)(windowImpl))(),baseLoc=apply3(map32(append2)(origin2(loc)))(pathname(loc))();return map32(catMaybes)($$for2(elements)(function(e){return runMaybeT(bind3(querySelector(e+" p")(toParentNode(doc)))(function(telem){return bind3(liftEffect1(map32(function(){var $449=drop3(1),$450=dropWhile(function(v){return notEq3(v)(codePointFromChar(":"))});return function($451){return $449($450($451))}}())(textContent(toNode(telem)))))(function(ttext){return bind3(map42(toNode)(querySelector(e+" p strong")(toParentNode2(telem))))(function(bnode){return discard3(liftEffect1($$void2(function __do2(){var anchor=createElement("a")(doc)();setAttribute("href")(baseLoc+e)(anchor)();setTextContent("#")(toNode(anchor))();return insertBefore(toNode(anchor))(bnode)(toNode(telem))()})))(function(){return pure4(new Tuple(e,ttext))})})})}))}))()}},blockTable=["_","\u2598","\u259D","\u2580","\u2596","\u258C","\u259E","\u259B","\u2597","\u259A","\u2590","\u259C","\u2584","\u2599","\u259F","\u2588"],blockToFourBit=function(c){return flip(map52)(elemIndex2(c)(blockTable))(function(n){return{nw:mod3(n)(2)===1,ne:mod3(div3(n)(2))(2)===1,sw:mod3(div3(n)(4))(2)===1,se:mod3(div3(n)(8))(2)===1}})},blocksToPoint=function(str){return fromFoldable52(bind1(zip(range2(0)(3))(fromFoldable62(split(".")(str))))(function(v){return bind1(zip(range2(0)(3))(fromFoldable62(toCharArray(v.value1))))(function(v1){return bind1(maybe(nil)(singleton4)(blockToFourBit(v1.value1)))(function(fb){return bind1(fourBitToPoint2(fb))(function(dp){var y=(2*v.value0|0)+dp.y|0,x=(2*v1.value0|0)+dp.x|0;return pure2({x,y})})})})}))},linkify=function(doc){return function(cb){return function __do(){var linkElems=querySelectorAll("a.loadpoints")(toParentNode(doc))();return flip(traverseNodeList_1)(linkElems)(function(linkElem){return $$void2(runMaybeT(discard3(liftEffect1(setAttribute("title")("Click to load")(linkElem)))(function(){return bind3(getAttribute("href")(linkElem))(function(href5){return bind3(map42(searchParams)(maybe(empty6)(pure4)(fromAbsolute(href5))))(function(usp){return bind3(maybe(empty6)(pure4)(get2("points")(usp)))(function(str){var res=blocksToPoint(str);return discard3(guard1(!$$null4(res)))(function(){return discard3(liftEffect1(onE(click2)(toEventTarget2(linkElem))(function(e){return function __do2(){preventDefault(e)();return cb(res)()}})))(function(){return pure4(unit)})})})})})})))})()}}},loadUri=function(doc){return runMaybeT(bind3(liftEffect1(bindFlipped2(location)(windowImpl)))(function(loc){return bind3(liftEffect1(map32(fromString)(search(loc))))(function(usp0){return bind3(maybe(empty6)(pure4)(get2("points")(usp0)))(function(str){var usp1=toString2($$delete3("points")(usp0)),res=blocksToPoint(str);return discard3(guard1(!$$null4(res)))(function(){return bind3(traverse2(title)(fromDocument(doc)))(function(origTitle){return discard3(liftEffect1(function __do(){var basicUrl=map32(fold2)(sequence2([origin2(loc),pathname(loc),hash(loc),pure22(function(){var $412=$$null2(usp1);if($412)return usp1;return"?"+usp1}())]))(),hist=bindFlipped2(history)(windowImpl)();return pushState(unsafeToForeign(basicUrl))(origTitle)(basicUrl)(hist)()}))(function(){return pure4(res)})})})})})}))},fourBitToBlock=function(fb){var go2=function(i){return function(b){if(b)return pow(2)(i);if(otherwise)return 0;throw new Error("Failed pattern match at Main (line 1024, column 3 - line 1026, column 20): "+[i.constructor.name,b.constructor.name])}};return fromMaybe(" ")(index(blockTable)(sum2(zipWith(go2)(iterate2(function(v){return v+1|0})(0))(fourBitList(fb)))))},pointsToBlocks=function(pts){var ptMap=fromFoldableWith2(append3)(map9(point2ToFourBit)(fromFoldable72(pts)));return intercalate1(".")(flip(map12)(range2(0)(3))(function(y){return flip(foldMap3)(range2(0)(3))(function(x){return maybe("_")(function($452){return singleton8(fourBitToBlock($452))})(lookup22({x,y})(ptMap))})}))},setupDrawer=function(sel){return function(size5){return runFn4(_setupDrawer)(sel)(size5)(function($453){return pointsToBlocks(fromFoldable8($453))})}},binom2=runFn2(_binom),vecRunNeighbs=function(n){return function(orig){var mx=maxBinom2(n)(orig)+1|0,go2=function(i){return function(j){return function(tot){return function(x0){return function(allSame){return function(p){return function(r){return function(x){return function(ls0){var v2=step(ls0);if(v2 instanceof Nil2){var res=r+x|0,p$prime=p*div3(factorial(res)*pow(2)(r)|0)(factorial(x)*factorial(r)|0)|0;return voidRight2(new Tuple(tot,p$prime))(guard22(!(allSame&&x===x0)))};if(v2 instanceof Cons2)return bind1(safeRange(0)(x+v2.value0|0))(function(xlContrib){return bind1(safeRange(max6(0)(xlContrib-x|0))(min5(v2.value0)(xlContrib)))(function(lContrib){var xContrib=xlContrib-lContrib|0,x$prime=x-xContrib|0,res2=r+xlContrib|0,tot$prime=tot+sum2(map12(function(k){return binom2((i+j|0)-k|0)(i-1|0)})(safeRange(1)(res2)))|0,p$prime2=p*div3(factorial(res2))((factorial(r)*factorial(xContrib)|0)*factorial(lContrib)|0)|0,l$prime=v2.value0-lContrib|0,j$prime=j-res2|0,i$prime=i-1|0;return go2(i$prime)(j$prime)(tot$prime)(v2.value0)(allSame&&xContrib===x0)(p$prime2)(x$prime)(l$prime)(v2.value1)})});throw new Error("Failed pattern match at Main (line 402, column 37 - line 438, column 62): "+[v2.constructor.name])}}}}}}}}},gens=genVecRunIxPascal(n)(mx)(orig),v=step(gens);if(v instanceof Nil2)return nil;if(v instanceof Cons2)return go2(mx)(n)(0)(v.value0)(true)(1)(0)(v.value0)(v.value1);throw new Error("Failed pattern match at Main (line 374, column 24 - line 376, column 46): "+[v.constructor.name])}},drawGolSyms5D=function(sel){return _drawGolSyms5D(sel,function(){var $454=map12(map62(Additive)),$455=vecRunNeighbs(3);return function($456){return toIntMap1($454($455($456)))}}())},runner=function(d){var highNeighbs=memoInt(function(){var $457=map12(map62(function(w){return w*2|0})),$458=vecRunNeighbs(d);return function($459){return toIntMap1($457($458($459)))}}()),$460=iterate2(function(v){return bindFlipped1(function(){var $463=stepper1(lowNeighbs)(highNeighbs);return function($464){return pure3($463($464))}}())(v)}),$461=map12(function(x){return new Tuple(x,singleton7(0))});return function($462){return $460(pure3(fromFoldable9($461(fromFoldable22($462)))))}},setupGol3D=function(sel){return function(size5){var drawer=function(){var $465=map9(function(v){return{x:mod3(v.value0.x)(size5.width),y:mod3(v.value0.y)(size5.height),zs:fromFoldable10(v.value1)}});return function($466){return $465(toUnfoldableUnordered1($466))}}(),preRun=function(){var $467=take(size5.maxT+1|0),$468=map12(map23(drawer)),$469=runner(1);return function($470){return fromFoldable42($467($468($469($470))))}}();return map32(function(v){return function($471){return v(preRun($471))}})(_setupGol3D(sel,size5))}},setupGol4D=function(sel){return function(size5){var drawer=function(){var $472=map9(function(v){return{x:mod3(v.value0.x)(size5.width),y:mod3(v.value0.y)(size5.height),zws:fromFoldable10(v.value1)}});return function($473){return $472(toUnfoldableUnordered1($473))}}(),preRun=function(){var $474=take(size5.maxT+1|0),$475=map12(map23(drawer)),$476=runner(2);return function($477){return fromFoldable42($474($475($476($477))))}}();return map32(function(v){return function($478){return v(preRun($478))}})(_setupGol4D(sel,size5))}},setupGolFlat=function(sel){return function(size5){var size$prime={height:size5.height,width:size5.width,maxT:size5.maxT,maxDim:toNullable(size5.maxDim)},drawer=function(){var $479=map9(function(v){return{x:mod3(v.value0.x)(size5.width),y:mod3(v.value0.y)(size5.height),pts:fromFoldable10(v.value1)}});return function($480){return $479(toUnfoldableUnordered1($480))}}(),preRun=function(pts){if(size5.maxDim instanceof Nothing)return fromFoldable42(map12(function(){var $481=map23(drawer);return function($482){return singleton2($481($482))}}())(take(size5.maxT+1|0)(runner(0)(pts))));if(size5.maxDim instanceof Just)return fromFoldable42(map12(fromFoldable42)(transpose(flip(map12)(range2(0)(size5.maxDim.value0))(function(d){return map12(map23(drawer))(take(size5.maxT+1|0)(runner(d)(pts)))}))));throw new Error("Failed pattern match at Main (line 774, column 16 - line 781, column 72): "+[size5.maxDim.constructor.name])};return map32(function(v){return function($483){return v(preRun($483))}})(_setupGolFlat(sel,isJust(size5.maxDim),size$prime))}},main=function(){var ready=function(doc){return function(a){return function __do(){var a$prime=doOnce(a)();return onE(readystatechange)(toEventTarget(doc))(function(v){return a$prime})()}}},bump=function(n){return function(v){return{x:v.x+n|0,y:v.y+n|0}}},initialSet=fromFoldable8(map9(bump(2))(initialPoints));return function __do(){var doc=bindFlipped2(function(){var $484=map32(toDocument);return function($485){return $484(document2($485))}}())(windowImpl)();return ready(doc)(function __do2(){logMe(13)();var startingPts=map32(fromMaybe(initialSet))(loadUri(doc))(),eMap=buildElemMap(doc)();makeElemLinks(doc)(eMap)();var draw2D=setupGolFlat("#gol2DCont")({height:20,width:20,maxT:6,maxDim:Nothing.value})(),draw3D=setupGol3D("#gol3DCont")({height:20,width:20,maxT:6})(),draw4D=setupGol4D("#gol4DCont")({height:20,width:20,maxT:6})(),drawFlat=setupGolFlat("#golFlatCont")({height:20,width:20,maxT:6,maxDim:new Just(8)})();drawGolSyms3D("#golSyms3DForwardCont")(6)(false)();drawGolSyms3D("#golSyms3DReverseCont")(6)(true)();drawGolSyms4D("#golSyms4DForwardCont")(6)(false)();drawGolSyms4D("#golSyms4DReverseCont")(6)(true)();drawTree("#golTreeCont")();drawGolSyms5D("#golSyms5DCont")();var drawer=setupDrawer("#golDrawerCont")({height:8,width:8})(function(pts){var bumped=fromFoldable8(map9(bump(6))(pts));return function __do3(){draw2D(bumped)();draw3D(bumped)();draw4D(bumped)();return drawFlat(bumped)()}})();drawer(fromFoldable72(startingPts))();return linkify(doc)(function($486){return drawer(fromFoldable72($486))})()})()}}();main()})()