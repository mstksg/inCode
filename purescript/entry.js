(()=>{var arrayMap=function(f){return function(arr){var l=arr.length,result=new Array(l);for(var i=0;i<l;i++)result[i]=f(arr[i]);return result}},semigroupoidFn={compose:function(f){return function(g){return function(x){return f(g(x))}}}},identity=function(dict){return dict.identity},categoryFn={identity:function(x){return x},Semigroupoid0:function(){return semigroupoidFn}},otherwise=true,flip=function(f){return function(b){return function(a){return f(a)(b)}}},$$const=function(a){return function(v){return a}},unit=void 0,map=function(dict){return dict.map},$$void=function(dictFunctor){return map(dictFunctor)($$const(unit))},functorArray={map:arrayMap},concatString=function(s1){return function(s2){return s1+s2}},semigroupString={append:concatString},append=function(dict){return dict.append},alt=function(dict){return dict.alt},arrayApply=function(fs){return function(xs){var l=fs.length,k=xs.length,result=new Array(l*k),n=0;for(var i=0;i<l;i++){var f=fs[i];for(var j=0;j<k;j++)result[n++]=f(xs[j])};return result}},identity2=identity(categoryFn),applyArray={apply:arrayApply,Functor0:function(){return functorArray}},apply=function(dict){return dict.apply},applySecond=function(dictApply){var apply1=apply(dictApply),map7=map(dictApply.Functor0());return function(a){return function(b){return apply1(map7($$const(identity2))(a))(b)}}},pure=function(dict){return dict.pure},unless=function(dictApplicative){var pure12=pure(dictApplicative);return function(v){return function(v1){if(!v)return v1;if(v)return pure12(unit);throw new Error("Failed pattern match at Control.Applicative (line 68, column 1 - line 68, column 65): "+[v.constructor.name,v1.constructor.name])}}},when=function(dictApplicative){var pure12=pure(dictApplicative);return function(v){return function(v1){if(v)return v1;if(!v)return pure12(unit);throw new Error("Failed pattern match at Control.Applicative (line 63, column 1 - line 63, column 63): "+[v.constructor.name,v1.constructor.name])}}},liftA1=function(dictApplicative){var apply2=apply(dictApplicative.Apply0()),pure12=pure(dictApplicative);return function(f){return function(a){return apply2(pure12(f))(a)}}},arrayBind=function(arr){return function(f){var result=[];for(var i=0,l=arr.length;i<l;i++)Array.prototype.push.apply(result,f(arr[i]));return result}},discard=function(dict){return dict.discard},bindArray={bind:arrayBind,Apply0:function(){return applyArray}},bind=function(dict){return dict.bind},bindFlipped=function(dictBind){return flip(bind(dictBind))},composeKleisliFlipped=function(dictBind){var bindFlipped1=bindFlipped(dictBind);return function(f){return function(g){return function(a){return bindFlipped1(f)(g(a))}}}},discardUnit={discard:function(dictBind){return bind(dictBind)}},liftM1=function(dictMonad){var bind3=bind(dictMonad.Bind1()),pure2=pure(dictMonad.Applicative0());return function(f){return function(a){return bind3(a)(function(a$prime){return pure2(f(a$prime))})}}},ap=function(dictMonad){var bind3=bind(dictMonad.Bind1()),pure2=pure(dictMonad.Applicative0());return function(f){return function(a){return bind3(f)(function(f$prime){return bind3(a)(function(a$prime){return pure2(f$prime(a$prime))})})}}},topInt=2147483647,bottomInt=-2147483648,topChar=String.fromCharCode(65535),bottomChar=String.fromCharCode(0),topNumber=Number.POSITIVE_INFINITY,bottomNumber=Number.NEGATIVE_INFINITY,unsafeCompareImpl=function(lt){return function(eq2){return function(gt){return function(x){return function(y){return x<y?lt:x===y?eq2:gt}}}}},ordIntImpl=unsafeCompareImpl,ordCharImpl=unsafeCompareImpl,refEq=function(r1){return function(r2){return r1===r2}},eqIntImpl=refEq,eqCharImpl=refEq,eqInt={eq:eqIntImpl},eqChar={eq:eqCharImpl},eq=function(dict){return dict.eq},LT=function(){function LT2(){};LT2.value=new LT2();return LT2}(),GT=function(){function GT2(){};GT2.value=new GT2();return GT2}(),EQ=function(){function EQ2(){};EQ2.value=new EQ2();return EQ2}(),ordInt=function(){return{compare:ordIntImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqInt}}}(),ordChar=function(){return{compare:ordCharImpl(LT.value)(EQ.value)(GT.value),Eq0:function(){return eqChar}}}(),compare=function(dict){return dict.compare},top=function(dict){return dict.top},boundedInt={top:topInt,bottom:bottomInt,Ord0:function(){return ordInt}},boundedChar={top:topChar,bottom:bottomChar,Ord0:function(){return ordChar}},bottom=function(dict){return dict.bottom},identity3=identity(categoryFn),Nothing=function(){function Nothing2(){};Nothing2.value=new Nothing2();return Nothing2}(),Just=function(){function Just2(value0){this.value0=value0};Just2.create=function(value0){return new Just2(value0)};return Just2}(),maybe=function(v){return function(v1){return function(v2){if(v2 instanceof Nothing)return v;if(v2 instanceof Just)return v1(v2.value0);throw new Error("Failed pattern match at Data.Maybe (line 237, column 1 - line 237, column 51): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}},isNothing=maybe(true)($$const(false)),isJust=maybe(false)($$const(true)),functorMaybe={map:function(v){return function(v1){if(v1 instanceof Just)return new Just(v(v1.value0));return Nothing.value}}},fromMaybe=function(a){return maybe(a)(identity3)},fromJust=function(){return function(v){if(v instanceof Just)return v.value0;throw new Error("Failed pattern match at Data.Maybe (line 288, column 1 - line 288, column 46): "+[v.constructor.name])}},altMaybe={alt:function(v){return function(v1){if(v instanceof Nothing)return v1;return v}},Functor0:function(){return functorMaybe}},Left=function(){function Left2(value0){this.value0=value0};Left2.create=function(value0){return new Left2(value0)};return Left2}(),Right=function(){function Right2(value0){this.value0=value0};Right2.create=function(value0){return new Right2(value0)};return Right2}(),pureE=function(a){return function(){return a}},bindE=function(a){return function(f){return function(){return f(a())()}}},monoidString={mempty:"",Semigroup0:function(){return semigroupString}},mempty=function(dict){return dict.mempty},$runtime_lazy=function(name15,moduleName,init){var state3=0,val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init();state3=2;return val}},monadEffect={Applicative0:function(){return applicativeEffect},Bind1:function(){return bindEffect}},bindEffect={bind:bindE,Apply0:function(){return $lazy_applyEffect(0)}},applicativeEffect={pure:pureE,Apply0:function(){return $lazy_applyEffect(0)}},$lazy_functorEffect=$runtime_lazy("functorEffect","Effect",function(){return{map:liftA1(applicativeEffect)}}),$lazy_applyEffect=$runtime_lazy("applyEffect","Effect",function(){return{apply:ap(monadEffect),Functor0:function(){return $lazy_functorEffect(0)}}}),functorEffect=$lazy_functorEffect(20),_new=function(val){return function(){return{value:val}}},read=function(ref){return function(){return ref.value}},write=function(val){return function(ref){return function(){ref.value=val}}},$$new=_new,boolConj=function(b1){return function(b2){return b1&&b2}},boolDisj=function(b1){return function(b2){return b1||b2}},boolNot=function(b){return!b},tt=function(dict){return dict.tt},not=function(dict){return dict.not},disj=function(dict){return dict.disj},heytingAlgebraBoolean={ff:false,tt:true,implies:function(a){return function(b){return disj(heytingAlgebraBoolean)(not(heytingAlgebraBoolean)(a))(b)}},conj:boolConj,disj:boolDisj,not:boolNot},conj=function(dict){return dict.conj},Tuple=function(){function Tuple2(value0,value1){this.value0=value0;this.value1=value1};Tuple2.create=function(value0){return function(value1){return new Tuple2(value0,value1)}};return Tuple2}(),snd=function(v){return v.value1},fst=function(v){return v.value0},lift=function(dict){return dict.lift},tell=function(dict){return dict.tell},monadEffectEffect={liftEffect:identity(categoryFn),Monad0:function(){return monadEffect}},liftEffect=function(dict){return dict.liftEffect},map2=map(functorMaybe),MaybeT=function(x){return x},runMaybeT=function(v){return v},monadTransMaybeT={lift:function(dictMonad){var $157=liftM1(dictMonad)(Just.create);return function($158){return MaybeT($157($158))}}},lift3=lift(monadTransMaybeT),functorMaybeT=function(dictFunctor){var map12=map(dictFunctor);return{map:function(f){return function(v){return map12(map2(f))(v)}}}},monadMaybeT=function(dictMonad){return{Applicative0:function(){return applicativeMaybeT(dictMonad)},Bind1:function(){return bindMaybeT(dictMonad)}}},bindMaybeT=function(dictMonad){var bind3=bind(dictMonad.Bind1()),pure2=pure(dictMonad.Applicative0());return{bind:function(v){return function(f){return bind3(v)(function(v1){if(v1 instanceof Nothing)return pure2(Nothing.value);if(v1 instanceof Just){var v2=f(v1.value0);return v2};throw new Error("Failed pattern match at Control.Monad.Maybe.Trans (line 54, column 11 - line 56, column 42): "+[v1.constructor.name])})}},Apply0:function(){return applyMaybeT(dictMonad)}}},applyMaybeT=function(dictMonad){var functorMaybeT1=functorMaybeT(dictMonad.Bind1().Apply0().Functor0());return{apply:ap(monadMaybeT(dictMonad)),Functor0:function(){return functorMaybeT1}}},applicativeMaybeT=function(dictMonad){return{pure:function(){var $159=pure(dictMonad.Applicative0());return function($160){return MaybeT($159(Just.create($160)))}}(),Apply0:function(){return applyMaybeT(dictMonad)}}},monadEffectMaybe=function(dictMonadEffect){var Monad0=dictMonadEffect.Monad0(),monadMaybeT1=monadMaybeT(Monad0);return{liftEffect:function(){var $161=lift3(Monad0),$162=liftEffect(dictMonadEffect);return function($163){return $161($162($163))}}(),Monad0:function(){return monadMaybeT1}}},altMaybeT=function(dictMonad){var Bind1=dictMonad.Bind1(),bind3=bind(Bind1),pure2=pure(dictMonad.Applicative0()),functorMaybeT1=functorMaybeT(Bind1.Apply0().Functor0());return{alt:function(v){return function(v1){return bind3(v)(function(m){if(m instanceof Nothing)return v1;return pure2(m)})}},Functor0:function(){return functorMaybeT1}}},plusMaybeT=function(dictMonad){var altMaybeT1=altMaybeT(dictMonad);return{empty:pure(dictMonad.Applicative0())(Nothing.value),Alt0:function(){return altMaybeT1}}},empty=function(dict){return dict.empty},monadTransStateT={lift:function(dictMonad){var bind3=bind(dictMonad.Bind1()),pure2=pure(dictMonad.Applicative0());return function(m){return function(s){return bind3(m)(function(x){return pure2(new Tuple(x,s))})}}}},lift4=lift(monadTransStateT),functorStateT=function(dictFunctor){var map7=map(dictFunctor);return{map:function(f){return function(v){return function(s){return map7(function(v1){return new Tuple(f(v1.value0),v1.value1)})(v(s))}}}}},evalStateT=function(dictFunctor){var map7=map(dictFunctor);return function(v){return function(s){return map7(fst)(v(s))}}},monadStateT=function(dictMonad){return{Applicative0:function(){return applicativeStateT(dictMonad)},Bind1:function(){return bindStateT(dictMonad)}}},bindStateT=function(dictMonad){var bind3=bind(dictMonad.Bind1());return{bind:function(v){return function(f){return function(s){return bind3(v(s))(function(v1){var v3=f(v1.value0);return v3(v1.value1)})}}},Apply0:function(){return applyStateT(dictMonad)}}},applyStateT=function(dictMonad){var functorStateT1=functorStateT(dictMonad.Bind1().Apply0().Functor0());return{apply:ap(monadStateT(dictMonad)),Functor0:function(){return functorStateT1}}},applicativeStateT=function(dictMonad){var pure2=pure(dictMonad.Applicative0());return{pure:function(a){return function(s){return pure2(new Tuple(a,s))}},Apply0:function(){return applyStateT(dictMonad)}}},monadEffectState=function(dictMonadEffect){var Monad0=dictMonadEffect.Monad0(),monadStateT1=monadStateT(Monad0);return{liftEffect:function(){var $197=lift4(Monad0),$198=liftEffect(dictMonadEffect);return function($199){return $197($198($199))}}(),Monad0:function(){return monadStateT1}}},WriterT=function(x){return x},monadTransWriterT=function(dictMonoid){var mempty2=mempty(dictMonoid);return{lift:function(dictMonad){var bind3=bind(dictMonad.Bind1()),pure2=pure(dictMonad.Applicative0());return function(m){return bind3(m)(function(a){return pure2(new Tuple(a,mempty2))})}}}},mapWriterT=function(f){return function(v){return f(v)}},functorWriterT=function(dictFunctor){var map7=map(dictFunctor);return{map:function(f){return mapWriterT(map7(function(v){return new Tuple(f(v.value0),v.value1)}))}}},execWriterT=function(dictFunctor){var map7=map(dictFunctor);return function(v){return map7(snd)(v)}},applyWriterT=function(dictSemigroup){var append2=append(dictSemigroup);return function(dictApply){var apply2=apply(dictApply),Functor0=dictApply.Functor0(),map7=map(Functor0),functorWriterT1=functorWriterT(Functor0);return{apply:function(v){return function(v1){var k=function(v3){return function(v4){return new Tuple(v3.value0(v4.value0),append2(v3.value1)(v4.value1))}};return apply2(map7(k)(v))(v1)}},Functor0:function(){return functorWriterT1}}}},bindWriterT=function(dictSemigroup){var append2=append(dictSemigroup),applyWriterT1=applyWriterT(dictSemigroup);return function(dictBind){var bind3=bind(dictBind),Apply0=dictBind.Apply0(),map7=map(Apply0.Functor0()),applyWriterT2=applyWriterT1(Apply0);return{bind:function(v){return function(k){return bind3(v)(function(v1){var v2=k(v1.value0);return map7(function(v3){return new Tuple(v3.value0,append2(v1.value1)(v3.value1))})(v2)})}},Apply0:function(){return applyWriterT2}}}},applicativeWriterT=function(dictMonoid){var mempty2=mempty(dictMonoid),applyWriterT1=applyWriterT(dictMonoid.Semigroup0());return function(dictApplicative){var pure2=pure(dictApplicative),applyWriterT2=applyWriterT1(dictApplicative.Apply0());return{pure:function(a){return pure2(new Tuple(a,mempty2))},Apply0:function(){return applyWriterT2}}}},monadWriterT=function(dictMonoid){var applicativeWriterT1=applicativeWriterT(dictMonoid),bindWriterT1=bindWriterT(dictMonoid.Semigroup0());return function(dictMonad){var applicativeWriterT2=applicativeWriterT1(dictMonad.Applicative0()),bindWriterT22=bindWriterT1(dictMonad.Bind1());return{Applicative0:function(){return applicativeWriterT2},Bind1:function(){return bindWriterT22}}}},monadEffectWriter=function(dictMonoid){var lift5=lift(monadTransWriterT(dictMonoid)),monadWriterT1=monadWriterT(dictMonoid);return function(dictMonadEffect){var Monad0=dictMonadEffect.Monad0(),monadWriterT2=monadWriterT1(Monad0);return{liftEffect:function(){var $249=lift5(Monad0),$250=liftEffect(dictMonadEffect);return function($251){return $249($250($251))}}(),Monad0:function(){return monadWriterT2}}}},monadTellWriterT=function(dictMonoid){var Semigroup0=dictMonoid.Semigroup0(),monadWriterT1=monadWriterT(dictMonoid);return function(dictMonad){var monadWriterT2=monadWriterT1(dictMonad);return{tell:function(){var $252=pure(dictMonad.Applicative0()),$253=Tuple.create(unit);return function($254){return WriterT($252($253($254)))}}(),Semigroup0:function(){return Semigroup0},Monad1:function(){return monadWriterT2}}}},replicateFill=function(count,value12){if(count<1)return[];var result=new Array(count);return result.fill(value12)},replicatePolyfill=function(count,value12){var result=[],n=0;for(var i=0;i<count;i++)result[n++]=value12;return result},replicateImpl=typeof Array.prototype.fill==="function"?replicateFill:replicatePolyfill,length=function(xs){return xs.length},findIndexImpl=function(just,nothing,f,xs){for(var i=0,l=xs.length;i<l;i++)if(f(xs[i]))return just(i);return nothing},unsafeIndexImpl=function(xs,n){return xs[n]},foldrArray=function(f){return function(init){return function(xs){var acc=init,len=xs.length;for(var i=len-1;i>=0;i--)acc=f(xs[i])(acc);return acc}}},foldlArray=function(f){return function(init){return function(xs){var acc=init,len=xs.length;for(var i=0;i<len;i++)acc=f(acc)(xs[i]);return acc}}},Conj=function(x){return x},semigroupConj=function(dictHeytingAlgebra){var conj2=conj(dictHeytingAlgebra);return{append:function(v){return function(v1){return conj2(v)(v1)}}}},monoidConj=function(dictHeytingAlgebra){var semigroupConj1=semigroupConj(dictHeytingAlgebra);return{mempty:tt(dictHeytingAlgebra),Semigroup0:function(){return semigroupConj1}}},unsafeCoerce2=function(x){return x},coerce=function(){return unsafeCoerce2},coerce2=coerce(),alaF=function(){return function(){return function(){return function(){return function(v){return coerce2}}}}},alaF2=alaF()()()(),foldr=function(dict){return dict.foldr},traverse_=function(dictApplicative){var applySecond2=applySecond(dictApplicative.Apply0()),pure2=pure(dictApplicative);return function(dictFoldable){var foldr2=foldr(dictFoldable);return function(f){return foldr2(function($454){return applySecond2(f($454))})(pure2(unit))}}},for_=function(dictApplicative){var traverse_1=traverse_(dictApplicative);return function(dictFoldable){return flip(traverse_1(dictFoldable))}},foldl=function(dict){return dict.foldl},intercalate=function(dictFoldable){var foldl2=foldl(dictFoldable);return function(dictMonoid){var append2=append(dictMonoid.Semigroup0()),mempty2=mempty(dictMonoid);return function(sep){return function(xs){var go2=function(v){return function(v1){if(v.init)return{init:false,acc:v1};return{init:false,acc:append2(v.acc)(append2(sep)(v1))}}};return foldl2(go2)({init:true,acc:mempty2})(xs).acc}}}},foldableMaybe={foldr:function(v){return function(v1){return function(v2){if(v2 instanceof Nothing)return v1;if(v2 instanceof Just)return v(v2.value0)(v1);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}},foldl:function(v){return function(v1){return function(v2){if(v2 instanceof Nothing)return v1;if(v2 instanceof Just)return v(v1)(v2.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[v.constructor.name,v1.constructor.name,v2.constructor.name])}}},foldMap:function(dictMonoid){var mempty2=mempty(dictMonoid);return function(v){return function(v1){if(v1 instanceof Nothing)return mempty2;if(v1 instanceof Just)return v(v1.value0);throw new Error("Failed pattern match at Data.Foldable (line 138, column 1 - line 144, column 27): "+[v.constructor.name,v1.constructor.name])}}}},foldMapDefaultR=function(dictFoldable){var foldr2=foldr(dictFoldable);return function(dictMonoid){var append2=append(dictMonoid.Semigroup0()),mempty2=mempty(dictMonoid);return function(f){return foldr2(function(x){return function(acc){return append2(f(x))(acc)}})(mempty2)}}},foldableArray={foldr:foldrArray,foldl:foldlArray,foldMap:function(dictMonoid){return foldMapDefaultR(foldableArray)(dictMonoid)}},foldMap=function(dict){return dict.foldMap},all=function(dictFoldable){var foldMap2=foldMap(dictFoldable);return function(dictHeytingAlgebra){return alaF2(Conj)(foldMap2(monoidConj(dictHeytingAlgebra)))}},runFn2=function(fn){return function(a){return function(b){return fn(a,b)}}},runFn4=function(fn){return function(a){return function(b){return function(c){return function(d){return fn(a,b,c,d)}}}}},unfoldrArrayImpl=function(isNothing2){return function(fromJust4){return function(fst2){return function(snd2){return function(f){return function(b){var result=[],value12=b;while(true){var maybe2=f(value12);if(isNothing2(maybe2))return result;var tuple=fromJust4(maybe2);result.push(fst2(tuple));value12=snd2(tuple)}}}}}}},unfoldr1ArrayImpl=function(isNothing2){return function(fromJust4){return function(fst2){return function(snd2){return function(f){return function(b){var result=[],value12=b;while(true){var tuple=f(value12);result.push(fst2(tuple));var maybe2=snd2(tuple);if(isNothing2(maybe2))return result;value12=fromJust4(maybe2)}}}}}}},fromJust2=fromJust(),unfoldable1Array={unfoldr1:unfoldr1ArrayImpl(isNothing)(fromJust2)(fst)(snd)},fromJust3=fromJust(),unfoldr=function(dict){return dict.unfoldr},unfoldableArray={unfoldr:unfoldrArrayImpl(isNothing)(fromJust3)(fst)(snd),Unfoldable10:function(){return unfoldable1Array}},unsafeIndex=function(){return runFn2(unsafeIndexImpl)},singleton2=function(a){return[a]},findIndex=function(){return runFn4(findIndexImpl)(Just.create)(Nothing.value)}(),elemIndex=function(dictEq){var eq2=eq(dictEq);return function(x){return findIndex(function(v){return eq2(v)(x)})}},concatMap=flip(bind(bindArray)),mapMaybe=function(f){return concatMap(function(){var $189=maybe([])(singleton2);return function($190){return $189(f($190))}}())};function toCharCode(c){return c.charCodeAt(0)}
function fromCharCode(c){return String.fromCharCode(c)};var bottom1=bottom(boundedChar),top1=top(boundedChar),toEnum=function(dict){return dict.toEnum},fromEnum=function(dict){return dict.fromEnum},defaultSucc=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)+1|0)}}},defaultPred=function(toEnum$prime){return function(fromEnum$prime){return function(a){return toEnum$prime(fromEnum$prime(a)-1|0)}}},charToEnum=function(v){if(v>=toCharCode(bottom1)&&v<=toCharCode(top1))return new Just(fromCharCode(v));return Nothing.value},enumChar={succ:defaultSucc(charToEnum)(toCharCode),pred:defaultPred(charToEnum)(toCharCode),Ord0:function(){return ordChar}},boundedEnumChar=function(){return{cardinality:toCharCode(top1)-toCharCode(bottom1)|0,toEnum:charToEnum,fromEnum:toCharCode,Bounded0:function(){return boundedChar},Enum1:function(){return enumChar}}}(),fromNumberImpl=function(just){return function(nothing){return function(n){return(n|0)===n?just(n):nothing}}},toNumber=function(n){return n},isFiniteImpl=isFinite,floor=Math.floor,top2=top(boundedInt),bottom2=bottom(boundedInt),fromNumber=function(){return fromNumberImpl(Just.create)(Nothing.value)}(),unsafeClamp=function(x){if(!isFiniteImpl(x))return 0;if(x>=toNumber(top2))return top2;if(x<=toNumber(bottom2))return bottom2;if(otherwise)return fromMaybe(0)(fromNumber(x));throw new Error("Failed pattern match at Data.Int (line 72, column 1 - line 72, column 29): "+[x.constructor.name])},floor2=function($39){return unsafeClamp(floor($39))},unsafeIndex2=unsafeIndex(),elemIndex2=elemIndex(eqInt),NUMCAT_ZS=function(){function NUMCAT_ZS2(){};NUMCAT_ZS2.value=new NUMCAT_ZS2();return NUMCAT_ZS2}(),NUMCAT_CN=function(){function NUMCAT_CN2(){};NUMCAT_CN2.value=new NUMCAT_CN2();return NUMCAT_CN2}(),numSpaceBlocks=7,gencatZS=2,rule1=function(){return{category:gencatZS,unicodeCat:NUMCAT_ZS.value,possible:0,updist:0,lowdist:0,titledist:0}}(),spacechars=[{start:32,length:1,convRule:rule1},{start:160,length:1,convRule:rule1},{start:5760,length:1,convRule:rule1},{start:8192,length:11,convRule:rule1},{start:8239,length:1,convRule:rule1},{start:8287,length:1,convRule:rule1},{start:12288,length:1,convRule:rule1}],gencatLU=512,nullrule=function(){return{category:gencatLU,unicodeCat:NUMCAT_CN.value,possible:0,updist:0,lowdist:0,titledist:0}}(),bsearch=function(a){return function(array){return function(size3){return function(compare3){var go2=function($copy_i){return function($copy_k){var $tco_var_i=$copy_i,$tco_done=false,$tco_result;function $tco_loop(i,k){if(i>k||i>=length(array)){$tco_done=true;return Nothing.value};if(otherwise){var j=floor2(toNumber(i+k|0)/2),b=unsafeIndex2(array)(j),v=compare3(a)(b);if(v instanceof EQ){$tco_done=true;return new Just(b)};if(v instanceof GT){$tco_var_i=j+1|0;$copy_k=k;return};$tco_var_i=i;$copy_k=j-1|0;return};throw new Error("Failed pattern match at Data.CodePoint.Unicode.Internal (line 5622, column 3 - line 5632, column 30): "+[i.constructor.name,k.constructor.name])};while(!$tco_done)$tco_result=$tco_loop($tco_var_i,$copy_k);return $tco_result}};return go2(0)(size3)}}}},blkCmp=function(v){return function(v1){if(v.start>=v1.start&&v.start<(v1.start+v1.length|0))return EQ.value;if(v.start>v1.start)return GT.value;if(otherwise)return LT.value;throw new Error("Failed pattern match at Data.CodePoint.Unicode.Internal (line 5598, column 1 - line 5598, column 45): "+[v.constructor.name,v1.constructor.name])}},getRule=function(blocks){return function(unichar){return function(size3){var key={start:unichar,length:1,convRule:nullrule},maybeCharBlock=bsearch(key)(blocks)(size3)(blkCmp);if(maybeCharBlock instanceof Nothing)return Nothing.value;if(maybeCharBlock instanceof Just)return new Just(maybeCharBlock.value0.convRule);throw new Error("Failed pattern match at Data.CodePoint.Unicode.Internal (line 5612, column 5 - line 5614, column 60): "+[maybeCharBlock.constructor.name])}}},checkAttrS=function(categories){return function($$char){var maybeConversionRule=getRule(spacechars)($$char)(numSpaceBlocks);if(maybeConversionRule instanceof Nothing)return false;if(maybeConversionRule instanceof Just)return isJust(elemIndex2(maybeConversionRule.value0.category)(categories));throw new Error("Failed pattern match at Data.CodePoint.Unicode.Internal (line 5654, column 5 - line 5656, column 86): "+[maybeConversionRule.constructor.name])}},uIswspace=checkAttrS([gencatZS]),hasArrayFrom=typeof Array.from==="function",hasStringIterator=typeof Symbol!=="undefined"&&Symbol!=null&&typeof Symbol.iterator!=="undefined"&&typeof String.prototype[Symbol.iterator]==="function",hasFromCodePoint=typeof String.prototype.fromCodePoint==="function",hasCodePointAt=typeof String.prototype.codePointAt==="function",_unsafeCodePointAt0=function(fallback){return hasCodePointAt?function(str){return str.codePointAt(0)}:fallback},_toCodePointArray=function(fallback){return function(unsafeCodePointAt02){if(hasArrayFrom)return function(str){return Array.from(str,unsafeCodePointAt02)};return fallback}},length2=function(s){return s.length},drop=function(n){return function(s){return s.substring(n)}},splitAt=function(i){return function(s){return{before:s.substring(0,i),after:s.substring(i)}}},charAt=function(i){return function(s){if(i>=0&&i<s.length)return s.charAt(i);throw new Error("Data.String.Unsafe.charAt: Invalid index.")}},stripPrefix=function(v){return function(str){var v1=splitAt(length2(v))(str),$20=v1.before===v;if($20)return new Just(v1.after);return Nothing.value}},$runtime_lazy2=function(name15,moduleName,init){var state3=0,val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init();state3=2;return val}},fromEnum2=fromEnum(boundedEnumChar),map3=map(functorMaybe),unfoldr2=unfoldr(unfoldableArray),compare2=compare(ordInt),unsurrogate=function(lead){return function(trail){return(((lead-55296|0)*1024|0)+(trail-56320|0)|0)+65536|0}},isTrail=function(cu){return 56320<=cu&&cu<=57343},isLead=function(cu){return 55296<=cu&&cu<=56319},uncons=function(s){var v=length2(s);if(v===0)return Nothing.value;if(v===1)return new Just({head:fromEnum2(charAt(0)(s)),tail:""});var cu1=fromEnum2(charAt(1)(s)),cu0=fromEnum2(charAt(0)(s)),$43=isLead(cu0)&&isTrail(cu1);if($43)return new Just({head:unsurrogate(cu0)(cu1),tail:drop(2)(s)});return new Just({head:cu0,tail:drop(1)(s)})},unconsButWithTuple=function(s){return map3(function(v){return new Tuple(v.head,v.tail)})(uncons(s))},toCodePointArrayFallback=function(s){return unfoldr2(unconsButWithTuple)(s)},unsafeCodePointAt0Fallback=function(s){var cu0=fromEnum2(charAt(0)(s)),$47=isLead(cu0)&&length2(s)>1;if($47){var cu1=fromEnum2(charAt(1)(s)),$48=isTrail(cu1);if($48)return unsurrogate(cu0)(cu1);return cu0};return cu0},unsafeCodePointAt0=_unsafeCodePointAt0(unsafeCodePointAt0Fallback),toCodePointArray=_toCodePointArray(toCodePointArrayFallback)(unsafeCodePointAt0),eqCodePoint={eq:function(x){return function(y){return x===y}}},ordCodePoint={compare:function(x){return function(y){return compare2(x)(y)}},Eq0:function(){return eqCodePoint}},boundedCodePoint={bottom:0,top:1114111,Ord0:function(){return ordCodePoint}},boundedEnumCodePoint=function(){return{cardinality:1114111+1|0,fromEnum:function(v){return v},toEnum:function(n){if(n>=0&&n<=1114111)return new Just(n);if(otherwise)return Nothing.value;throw new Error("Failed pattern match at Data.String.CodePoints (line 63, column 1 - line 68, column 26): "+[n.constructor.name])},Bounded0:function(){return boundedCodePoint},Enum1:function(){return $lazy_enumCodePoint(0)}}}(),$lazy_enumCodePoint=$runtime_lazy2("enumCodePoint","Data.String.CodePoints",function(){return{succ:defaultSucc(toEnum(boundedEnumCodePoint))(fromEnum(boundedEnumCodePoint)),pred:defaultPred(toEnum(boundedEnumCodePoint))(fromEnum(boundedEnumCodePoint)),Ord0:function(){return ordCodePoint}}}),fromEnum3=fromEnum(boundedEnumCodePoint),isSpace=function(c){var uc=fromEnum3(c),$28=uc<=823;if($28)return uc===32||(uc>=9&&uc<=13||uc===160);return uIswspace(uc)},log2=function(s){return function(){console.log(s)}},log3=function(dictMonadEffect){var $67=liftEffect(dictMonadEffect);return function($68){return $67(log2($68))}};function add2(list){return function(token){return function(){return list.add(token)}}}
function remove(list){return function(token){return function(){return list.remove(token)}}}
function toggle(list){return function(token){return function(){return list.toggle(token)}}}
function nullable(a,r,f){return a==null?r:f(a)};var toMaybe=function(n){return nullable(n,Nothing.value,Just.create)},getEffProp=function(name15){return function(doc){return function(){return doc[name15]}}},url=getEffProp("URL"),documentURI=getEffProp("documentURI"),origin=getEffProp("origin"),compatMode=getEffProp("compatMode"),characterSet=getEffProp("characterSet"),contentType=getEffProp("contentType"),_documentElement=getEffProp("documentElement");function createElement(localName2){return function(doc){return function(){return doc.createElement(localName2)}}}
function _unsafeReadProtoTagged(nothing,just,name15,value12){if(typeof window!=="undefined"){var ty=window[name15];if(ty!=null&&value12 instanceof ty)return just(value12)};var obj=value12;while(obj!=null){var proto=Object.getPrototypeOf(obj),constructorName=proto.constructor.name;if(constructorName===name15){return just(value12)}else if(constructorName==="Object")return nothing;obj=proto};return nothing};var unsafeReadProtoTagged=function(name15){return function(value12){return _unsafeReadProtoTagged(Nothing.value,Just.create,name15,value12)}},toParentNode=unsafeCoerce2,toEventTarget=unsafeCoerce2,getProp=function(name15){return function(doctype){return doctype[name15]}},_namespaceURI=getProp("namespaceURI"),_prefix=getProp("prefix"),localName=getProp("localName"),tagName=getProp("tagName");function classList(element){return function(){return element.classList}}
function setClassName(className2){return function(node){return function(){node.className=className2}}}
function setAttribute(name15){return function(value12){return function(element){return function(){element.setAttribute(name15,value12)}}}};var getEffProp2=function(name15){return function(node){return function(){return node[name15]}}},children=getEffProp2("children"),_firstElementChild=getEffProp2("firstElementChild"),_lastElementChild=getEffProp2("lastElementChild"),childElementCount=getEffProp2("childElementCount");function _querySelector(selector){return function(node){return function(){return node.querySelector(selector)}}}
function querySelectorAll(selector){return function(node){return function(){return node.querySelectorAll(selector)}}};var map4=map(functorEffect),querySelector=function(qs){var $2=map4(toMaybe),$3=_querySelector(qs);return function($4){return $2($3($4))}},toNode=unsafeCoerce2,toEventTarget2=unsafeCoerce2,fromNode=unsafeReadProtoTagged("Element"),getEffProp3=function(name15){return function(node){return function(){return node[name15]}}},baseURI=getEffProp3("baseURI"),_ownerDocument=getEffProp3("ownerDocument"),_parentNode=getEffProp3("parentNode"),_parentElement=getEffProp3("parentElement"),childNodes=getEffProp3("childNodes"),_firstChild=getEffProp3("firstChild"),_lastChild=getEffProp3("lastChild"),_previousSibling=getEffProp3("previousSibling"),_nextSibling=getEffProp3("nextSibling"),_nodeValue=getEffProp3("nodeValue");function setNodeValue(value12){return function(node){return function(){node.nodeValue=value12}}};var textContent=getEffProp3("textContent");function setTextContent(value12){return function(node){return function(){node.textContent=value12}}}
function insertBefore(node1){return function(node2){return function(parent2){return function(){parent2.insertBefore(node1,node2)}}}}
function appendChild(node){return function(parent2){return function(){parent2.appendChild(node)}}}
function removeChild(node){return function(parent2){return function(){parent2.removeChild(node)}}};var map5=map(functorEffect),parentNode=function(){var $6=map5(toMaybe);return function($7){return $6(_parentNode($7))}}(),parentElement=function(){var $8=map5(toMaybe);return function($9){return $8(_parentElement($9))}}(),firstChild=function(){var $25=map5(toMaybe);return function($26){return $25(_firstChild($26))}}();function toArray(list){return function(){return[].slice.call(list)}}
function eventListener(fn){return function(){return function(event){return fn(event)()}}}
function addEventListener(type){return function(listener){return function(useCapture){return function(target5){return function(){return target5.addEventListener(type,listener,useCapture)}}}}};var windowImpl=function(){return window},toDocument=unsafeCoerce2;function document(window2){return function(){return window2.document}};var readystatechange="readystatechange",mouseleave="mouseleave",mouseenter="mouseenter",click2="click",$runtime_lazy3=function(name15,moduleName,init){var state3=0,val;return function(lineNumber){if(state3===2)return val;if(state3===1)throw new ReferenceError(name15+" was needed before it finished initializing (module "+moduleName+", line "+lineNumber+")",moduleName,lineNumber);state3=1;val=init();state3=2;return val}},alt5=alt(altMaybe),when2=when(applicativeEffect),$$void2=$$void(functorEffect),discard2=discard(discardUnit),bind1=bind(bindMaybeT(monadEffect)),liftEffect2=liftEffect(monadEffectMaybe(monadEffectEffect)),void1=$$void(functorWriterT(functorEffect)),empty2=empty(plusMaybeT(monadEffect)),pure1=pure(applicativeMaybeT(monadEffect)),map6=map(functorMaybe),for_2=for_(applicativeEffect),for_1=for_2(foldableArray),for_22=for_2(foldableMaybe),map1=map(functorEffect),all2=all(foldableArray)(heytingAlgebraBoolean),execWriterT2=execWriterT(functorEffect),unless2=unless(applicativeEffect),intercalate2=intercalate(foldableArray)(monoidString),log4=log3(monadEffectEffect),SMHover=function(){function SMHover2(){};SMHover2.value=new SMHover2();return SMHover2}(),SMOn=function(){function SMOn2(){};SMOn2.value=new SMOn2();return SMOn2}(),LS=function(){function LS2(value0){this.value0=value0};LS2.create=function(value0){return new LS2(value0)};return LS2}(),withIndex=function(dictApplicative){var Functor0=dictApplicative.Apply0().Functor0(),map22=map(Functor0),evalStateT2=evalStateT(Functor0);return function(t){return function(f){var f$prime=function(y){return function(i){return map22(function(z){return new Tuple(z,i+1|0)})(f(i)(y))}},$108=flip(evalStateT2)(0),$109=t(f$prime);return function($110){return $108($109($110))}}}},withIndex1=withIndex(applicativeEffect),traverseNodeList_=function(dictMonadEffect){var Monad0=dictMonadEffect.Monad0(),bind3=bind(Monad0.Bind1()),liftEffect22=liftEffect(dictMonadEffect),traverse_2=traverse_(Monad0.Applicative0())(foldableArray);return function(f){return function(nl){return bind3(liftEffect22(toArray(nl)))(function(ns){return traverse_2(f)(mapMaybe(fromNode)(ns))})}}},traverseNodeList_1=traverseNodeList_(monadEffectEffect),traverseNodeList_2=traverseNodeList_(monadEffectState(monadEffectEffect)),semigroupLS={append:function(v){return function(v1){return new LS({source:alt5(v.value0.source)(v1.value0.source),interactive:alt5(v.value0.interactive)(v1.value0.interactive)})}}},bindWriterT2=bindWriterT(semigroupLS)(bindEffect),bind2=bind(bindWriterT2),discard22=discard2(bindWriterT2),composeKleisliFlipped2=composeKleisliFlipped(bindWriterT2),onE=function(etype){return function(targ){return function(h){return function __do(){var listener=eventListener(h)();return addEventListener(etype)(listener)(false)(targ)()}}}},setupAsides=function(doc){return function __do(){var asides=querySelectorAll(".main-content .note")(toParentNode(doc))();return flip(traverseNodeList_1)(asides)(function(aside){return function __do2(){var blks=childNodes(toNode(aside))(),toggleAll=flip(withIndex1(traverseNodeList_2))(blks)(function(i){return function(blk){return when2(i>0)(function __do3(){var cList=classList(blk)();return $$void2(toggle(cList)("hide"))()})}});flip(withIndex1(traverseNodeList_2))(blks)(function(i){return function(blk){return when2(i===0)(function __do3(){var cList=classList(blk)();onE(click2)(toEventTarget2(blk))(function(v){return toggleAll})();add2(cList)("clickable")();add2(cList)("aside-header")();var clickMe=createElement("span")(doc)(),clickMeNode=toNode(clickMe),cmList=classList(clickMe)();add2(cmList)("clickme")();setTextContent("(Click me!)")(clickMeNode)();return $$void2(appendChild(clickMeNode)(toNode(blk)))()})}})();return toggleAll()}})()}},setupSourceLink=function(doc){var docPN=toParentNode(doc);return $$void2(runMaybeT(bind1(querySelector(".source-info")(docPN))(function(sourceInfo){return bind1(querySelector(".article > header")(docPN))(function(header){var headerET=toEventTarget2(header);return liftEffect2(function __do(){var cList=classList(sourceInfo)();add2(cList)("hide")();var modeRef=$$new(SMHover.value)();onE(mouseenter)(headerET)(function(v){return function __do2(){var mode=read(modeRef)();if(mode instanceof SMHover)return remove(cList)("hide")();if(mode instanceof SMOn)return unit;throw new Error("Failed pattern match at Main (line 101, column 13 - line 103, column 32): "+[mode.constructor.name])}})();onE(mouseleave)(headerET)(function(v){return function __do2(){var mode=read(modeRef)();if(mode instanceof SMHover)return add2(cList)("hide")();if(mode instanceof SMOn)return unit;throw new Error("Failed pattern match at Main (line 106, column 13 - line 108, column 32): "+[mode.constructor.name])}})();return onE(click2)(headerET)(function(v){return function __do2(){var mode=read(modeRef)();if(mode instanceof SMHover){remove(cList)("hide")();return write(SMOn.value)(modeRef)()};if(mode instanceof SMOn){add2(cList)("hide")();return write(SMHover.value)(modeRef)()};throw new Error("Failed pattern match at Main (line 111, column 13 - line 117, column 42): "+[mode.constructor.name])}})()})})})))},monoidLS=function(){return{mempty:new LS({source:Nothing.value,interactive:Nothing.value}),Semigroup0:function(){return semigroupLS}}}(),monadEffectWriter2=monadEffectWriter(monoidLS)(monadEffectEffect),liftEffect1=liftEffect(monadEffectWriter2),for_3=for_(applicativeWriterT(monoidLS)(applicativeEffect)),for_4=for_3(foldableArray),for_5=for_3(foldableMaybe),tell2=tell(monadTellWriterT(monoidLS)(monadEffect)),traverseNodeList_3=traverseNodeList_(monadEffectWriter2),processCodeBlocks=function(doc){var prefHandlers=[new Tuple("-- source: ",Left.create),new Tuple("-- interactive: ",Right.create)],pullLinkSpec=function(blk){return function(line){var lineN=toNode(line);return bind2(liftEffect1(textContent(lineN)))(function(linec){return for_4(prefHandlers)(function(v){return for_5(stripPrefix(v.value0)(linec))(function(stuff){return discard22(void1(liftEffect1(function __do(){setNodeValue("")(lineN)();return removeChild(lineN)(blk)()})))(function(){var v1=v.value1(stuff);if(v1 instanceof Left)return tell2(new LS({source:new Just(v1.value0),interactive:Nothing.value}));if(v1 instanceof Right)return tell2(new LS({source:Nothing.value,interactive:new Just(v1.value0)}));throw new Error("Failed pattern match at Main (line 204, column 13 - line 206, column 76): "+[v1.constructor.name])})})})})}},genLinkBox=function(v){return function(blk){return $$void2(runMaybeT(bind1(maybe(empty2)(pure1)(alt5(v.value0.source)(v.value0.interactive)))(function(){return bind1(parentNode(blk))(function(pre){return liftEffect2(function __do(){var linkBox=createElement("div")(doc)(),linkBoxN=toNode(linkBox);setClassName("code-link-box")(linkBox)();$$void2(insertBefore(linkBoxN)(blk)(pre))();var boxes=mapMaybe(function(v1){return map6(function(v2){return new Tuple(v2,v1.value1)})(v1.value0)})([new Tuple(v.value0.source,new Tuple("code-source-link","View full source")),new Tuple(v.value0.interactive,new Tuple("code-interactive-link","Interactive"))]);for_1(boxes)(function(v1){return function __do2(){var link=createElement("a")(doc)(),linkN=toNode(link);setAttribute("href")(v1.value0)(link)();setClassName(v1.value1.value0)(link)();setTextContent(v1.value1.value1)(linkN)();return $$void2(appendChild(linkN)(linkBoxN))()}})();var cList=classList(linkBox)();add2(cList)("hide")();var preET$prime=map6(toEventTarget2)(fromNode(pre));return for_22(preET$prime)(function(preET){return function __do2(){onE(mouseenter)(preET)(function(v1){return remove(cList)("hide")})();return onE(mouseleave)(preET)(function(v1){return add2(cList)("hide")})()}})()})})})))}},colorPrompt=function(blk){return $$void2(runMaybeT(bind1(firstChild(blk))(function(fc){return bind1(parentElement(blk))(function(pr){return liftEffect2(function __do(){var tc=textContent(fc)(),cList=classList(pr)(),isPrompt=mapMaybe(function(p){return stripPrefix(p)(tc)})(["\u03BB","ghci","$","irb",">>>"]);return when2(length(isPrompt)>0)(add2(cList)("code-block-prompt"))()})})})))},chompWhitespace=function(blk){var $lazy_go=$runtime_lazy3("go","Main",function(){return function __do(){var fc$prime=firstChild(blk)();return for_22(fc$prime)(function(fc){return function __do2(){var isWhitespace=map1(function(){var $111=all2(isSpace);return function($112){return $111(toCodePointArray($112))}}())(textContent(fc))();return when2(isWhitespace)(function __do3(){$$void2(removeChild(fc)(blk))();return $lazy_go(222)()})()}})()}}),go2=$lazy_go(216);return go2},childNodes$prime=function($113){return liftEffect1(childNodes($113))};return function __do(){var blks=querySelectorAll(".main-content code.sourceCode")(toParentNode(doc))();return flip(traverseNodeList_1)(blks)(function(blk){var blkN=toNode(blk);return function __do2(){var lSpec=execWriterT2(function(v){return composeKleisliFlipped2(v)(childNodes$prime)}(traverseNodeList_3(pullLinkSpec(blkN)))(blkN))();unit;chompWhitespace(blkN)();genLinkBox(lSpec)(blkN)();return colorPrompt(blkN)()}})()}},doOnce=function(a){return function __do(){var doneRef=$$new(false)();return function __do2(){var done=read(doneRef)();return unless2(done)(function __do3(){a();return write(true)(doneRef)()})()}}},appendTopLinks=function(doc){var headers=intercalate2(", ")([".main-content h2",".main-content h3",".main-content h4",".main-content h5"]);return function __do(){var hs=querySelectorAll(headers)(toParentNode(doc))();return flip(traverseNodeList_1)(hs)(function(h){return function __do2(){var topLink=createElement("a")(doc)(),topLinkNode=toNode(topLink);setAttribute("href")("#title")(topLink)();setClassName("top-link")(topLink)();setTextContent("top")(topLinkNode)();return $$void2(appendChild(topLinkNode)(toNode(h)))()}})()}},main=function(){var ready=function(doc){return function(a){return function __do(){var a$prime=doOnce(a)();return onE(readystatechange)(toEventTarget(doc))(function(v){return a$prime})()}}};return function __do(){var doc=bindFlipped(bindEffect)(function(){var $114=map1(toDocument);return function($115){return $114(document($115))}}())(windowImpl)();return ready(doc)(function __do2(){log4("Hello from PureScript!")();appendTopLinks(doc)();setupSourceLink(doc)();setupAsides(doc)();processCodeBlocks(doc)();return log4("Goodbye!")()})()}}();main()})()